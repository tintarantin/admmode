<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ADM mode: off script.</title>
  <meta name="description" content="ADM mode: off script. Протокол → MULTIPASS → билд." />

  <style>
    :root{
      --bg-0:#ffffff;
      --bg-1:#f6f1ff;
      --bg-2:#efe9ff;

      /* pearly / lilac / iridescent */
      --p-1:#c9b6ff;
      --p-2:#b9f0ff;
      --p-3:#ffd6f7;
      --p-4:#d6fff3;

      --ink:#0b0c14;
      --muted:rgba(11,12,20,.68);
      --shadow: 0 30px 80px rgba(12, 10, 30, .12);

      --radius: 28px;
      --max: 1120px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      color:var(--ink);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background:
        radial-gradient(1200px 700px at 15% 10%, rgba(185,240,255,.55), transparent 60%),
        radial-gradient(1000px 650px at 85% 20%, rgba(255,214,247,.52), transparent 62%),
        radial-gradient(900px 650px at 55% 90%, rgba(201,182,255,.50), transparent 60%),
        linear-gradient(180deg, var(--bg-0), var(--bg-1) 45%, var(--bg-2));
      overflow-x:hidden;
    }

    /* moving pearly light field */
    .aurora{
      position:fixed; inset:-40vh -40vw;
      pointer-events:none;
      filter: blur(44px) saturate(1.25);
      opacity:.62;
      background:
        conic-gradient(from 140deg,
          rgba(201,182,255,.0),
          rgba(201,182,255,.60),
          rgba(185,240,255,.58),
          rgba(255,214,247,.55),
          rgba(214,255,243,.52),
          rgba(201,182,255,.60),
          rgba(201,182,255,.0)
        );
      animation: drift 16s ease-in-out infinite;
      mix-blend-mode: soft-light;
      transform: translate3d(0,0,0);
    }
    @keyframes drift{
      0%{ transform: translate(-6vw,-3vh) rotate(0deg) scale(1); }
      50%{ transform: translate(6vw,3vh) rotate(18deg) scale(1.06); }
      100%{ transform: translate(-6vw,-3vh) rotate(0deg) scale(1); }
    }

    /* nav */
    .nav{
      position:sticky; top:0; z-index:30;
      backdrop-filter: blur(14px);
      background: linear-gradient(180deg, rgba(255,255,255,.72), rgba(255,255,255,.38));
      border-bottom: 1px solid rgba(255,255,255,.55);
    }
    .nav .wrap{
      max-width:var(--max);
      margin:0 auto;
      padding:14px 18px;
      display:flex; align-items:center; justify-content:space-between;
      gap:12px;
    }
    .brand{
      display:flex; align-items:baseline; gap:10px;
      letter-spacing:.08em;
      text-transform:uppercase;
      font-weight:900;
    }
    .brand small{
      font-weight:650;
      letter-spacing:.18em;
      opacity:.62;
      text-transform:none;
    }
    .nav a{
      color:var(--ink);
      text-decoration:none;
      font-weight:900;
      opacity:.78;
      transition: opacity .2s ease;
      letter-spacing:.10em;
      text-transform:uppercase;
      font-size:12px;
    }
    .nav a:hover{ opacity:1; }
    .nav .links{ display:flex; gap:16px; align-items:center; }

    .wrap{
      max-width:var(--max);
      margin:0 auto;
      padding:0 18px;
    }

    /* hero */
    .hero{
      position:relative;
      padding:64px 0 18px;
      isolation:isolate;
    }
    .iridescent-bg{
      position:absolute;
      inset:-30% -20%;
      z-index:-1;
      background:
        radial-gradient(700px 420px at 20% 30%, rgba(185,240,255,.65), transparent 60%),
        radial-gradient(600px 380px at 80% 25%, rgba(255,214,247,.60), transparent 62%),
        radial-gradient(620px 420px at 55% 75%, rgba(201,182,255,.58), transparent 60%),
        radial-gradient(540px 360px at 40% 60%, rgba(214,255,243,.52), transparent 60%);
      filter: blur(22px) saturate(1.15);
      animation: pearlFlow 14s ease-in-out infinite;
      transform: translate3d(0,0,0);
      pointer-events:none;
      mix-blend-mode: soft-light;
      opacity:.9;
    }
    @keyframes pearlFlow{
      0%{ transform: translate(-2%, -2%) scale(1); }
      50%{ transform: translate(2%, 2%) scale(1.06); }
      100%{ transform: translate(-2%, -2%) scale(1); }
    }

    .title{
      font-size: clamp(40px, 5.3vw, 84px);
      line-height: .98;
      margin:0 0 12px;
      letter-spacing:-.03em;
      font-weight:950;
    }
    .shimmer{
      display:inline-block;
      background:
        linear-gradient(110deg,
          rgba(15,14,35,1) 0%,
          rgba(15,14,35,1) 28%,
          rgba(255,255,255,.98) 40%,
          rgba(15,14,35,1) 52%,
          rgba(15,14,35,1) 100%),
        conic-gradient(from 140deg, var(--p-1), var(--p-2), var(--p-3), var(--p-4), var(--p-1));
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
      background-size: 220% 100%, 120% 120%;
      background-position: 0% 50%, 50% 50%;
      filter: drop-shadow(0 10px 26px rgba(12,10,30,.12));
      animation: shine 3.8s ease-in-out infinite;
    }
    @keyframes shine{
      0%{ background-position: 0% 50%, 50% 50%; }
      55%{ background-position: 100% 50%, 50% 50%; }
      100%{ background-position: 0% 50%, 50% 50%; }
    }

    .lead{
      max-width: 880px;
      font-size: clamp(16px, 1.55vw, 19px);
      line-height:1.6;
      color:var(--muted);
      margin: 0 0 14px;
      font-weight:750;
    }

    .chips{
      display:flex; flex-wrap:wrap; gap:10px;
      margin: 0 0 16px;
    }
    .chip{
      padding:10px 12px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.75);
      background: linear-gradient(180deg, rgba(255,255,255,.78), rgba(255,255,255,.44));
      backdrop-filter: blur(14px);
      box-shadow: 0 14px 44px rgba(12,10,30,.10);
      font-weight:900;
      letter-spacing:.10em;
      text-transform:uppercase;
      color: rgba(11,12,20,.86);
      position:relative;
      overflow:hidden;
      user-select:none;
      font-size:12px;
    }
    .chip::after{
      content:"";
      position:absolute; inset:-2px -30%;
      background: linear-gradient(90deg, transparent, rgba(185,240,255,.55), rgba(255,214,247,.55), transparent);
      transform: translateX(-40%);
      animation: chipshine 3.2s ease-in-out infinite;
      opacity:.9;
      mix-blend-mode: soft-light;
    }
    @keyframes chipshine{
      0%{ transform: translateX(-60%); }
      55%{ transform: translateX(60%); }
      100%{ transform: translateX(-60%); }
    }

    .ctaRow{
      display:flex; gap:12px; flex-wrap:wrap;
      align-items:center;
      margin: 10px 0 6px;
    }
    .btn{
      display:inline-flex; align-items:center; gap:10px;
      padding: 14px 16px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.75);
      background: linear-gradient(180deg, rgba(255,255,255,.78), rgba(255,255,255,.44));
      backdrop-filter: blur(14px);
      box-shadow: var(--shadow);
      color:rgba(11,12,20,.9);
      text-decoration:none;
      font-weight:950;
      letter-spacing:.06em;
      transition: transform .15s ease, box-shadow .2s ease, opacity .2s ease;
      cursor:pointer;
      position:relative;
      overflow:hidden;
      user-select:none;
      text-transform:uppercase;
      font-size:12px;
    }
    .btn:hover{ transform: translateY(-2px); box-shadow: 0 40px 100px rgba(12,10,30,.14); }
    .btn.primary::before{
      content:"";
      position:absolute; inset:-3px;
      background: conic-gradient(from 150deg,
        rgba(201,182,255,.75),
        rgba(185,240,255,.75),
        rgba(255,214,247,.70),
        rgba(214,255,243,.65),
        rgba(201,182,255,.75)
      );
      filter: blur(14px);
      opacity:.55;
      animation: halo 4.8s ease-in-out infinite;
      pointer-events:none;
    }
    @keyframes halo{
      0%{ transform: rotate(0deg) scale(1); }
      50%{ transform: rotate(18deg) scale(1.06); }
      100%{ transform: rotate(0deg) scale(1); }
    }
    .btn span{ position:relative; z-index:1; }
    .btn.ghost{ opacity:.78; }
    .btn.ghost:hover{ opacity:1; }
    .btn:disabled{ opacity:.45; cursor:not-allowed; transform:none !important; }

    /* cards / layout */
    .grid{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap:18px;
      margin: 18px 0 22px;
    }
    @media (max-width: 940px){
      .grid{ grid-template-columns: 1fr; }
    }

    .card{
      border-radius: var(--radius);
      border:1px solid rgba(255,255,255,.70);
      background: linear-gradient(180deg, rgba(255,255,255,.74), rgba(255,255,255,.36));
      backdrop-filter: blur(16px);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .card::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        conic-gradient(from 140deg,
          rgba(201,182,255,.0),
          rgba(201,182,255,.65),
          rgba(185,240,255,.62),
          rgba(255,214,247,.58),
          rgba(214,255,243,.50),
          rgba(201,182,255,.65),
          rgba(201,182,255,.0)
        );
      filter: blur(14px);
      opacity:.52;
      animation: borderFlow 7.2s ease-in-out infinite;
      pointer-events:none;
    }
    @keyframes borderFlow{
      0%{ transform: rotate(0deg); }
      50%{ transform: rotate(26deg); }
      100%{ transform: rotate(0deg); }
    }
    .card > .inner{
      position:relative;
      padding: 22px 22px 18px;
      z-index:1;
    }

    .h2{
      margin:0 0 10px;
      font-size: 12px;
      letter-spacing:.20em;
      text-transform:uppercase;
      opacity:.78;
      font-weight:950;
    }

    .manifest{
      margin: 0;
      font-size: clamp(18px, 1.85vw, 22px);
      line-height: 1.55;
      letter-spacing: -.01em;
      color: rgba(11,12,20,.92);
      font-weight:800;
    }

    .list{
      margin:14px 0 0;
      padding:0;
      list-style:none;
      display:grid;
      gap:12px;
    }
    .item{
      padding:14px 14px;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.68);
      background: linear-gradient(180deg, rgba(255,255,255,.68), rgba(255,255,255,.35));
      position:relative;
      overflow:hidden;
    }
    .item b{
      display:flex; align-items:center; justify-content:space-between;
      font-size:12px;
      letter-spacing:.18em;
      text-transform:uppercase;
      opacity:.70;
      margin-bottom:6px;
      font-weight:950;
    }
    .tag{
      font-size:11px;
      letter-spacing:.18em;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.65);
      background: linear-gradient(180deg, rgba(255,255,255,.66), rgba(255,255,255,.32));
      opacity:.92;
      text-transform:uppercase;
      font-weight:900;
    }
    .item p{ margin:0; color:var(--muted); line-height:1.45; font-weight:700; }

    /* reveal */
    .reveal{ opacity:0; transform: translateY(16px); transition: opacity .7s ease, transform .7s ease; }
    .reveal.on{ opacity:1; transform: translateY(0); }

    /* ---------- PROTOCOL SIGNING ---------- */
    .protocolPanel{ display:grid; gap:12px; }
    .console{
      border-radius: 20px;
      border:1px solid rgba(255,255,255,.70);
      background: linear-gradient(180deg, rgba(255,255,255,.70), rgba(255,255,255,.32));
      padding: 14px 14px;
      position:relative;
      overflow:hidden;
    }
    .console::before{
      content:"";
      position:absolute; inset:-1px;
      background: linear-gradient(90deg, transparent 0%, rgba(185,240,255,.25) 35%, rgba(255,214,247,.22) 55%, transparent 100%);
      transform: translateX(-60%);
      animation: scan 4.2s ease-in-out infinite;
      opacity:.55;
      mix-blend-mode: soft-light;
      pointer-events:none;
    }
    @keyframes scan{
      0%{ transform: translateX(-60%); }
      55%{ transform: translateX(60%); }
      100%{ transform: translateX(-60%); }
    }
    .console .row{ display:flex; gap:10px; align-items:center; justify-content:space-between; flex-wrap:wrap; }
    .kv{
      display:flex; gap:10px; align-items:center;
      font-weight:950;
      letter-spacing:.18em;
      text-transform:uppercase;
      font-size:12px;
      opacity:.78;
    }
    .pill{
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.65);
      background: linear-gradient(180deg, rgba(255,255,255,.66), rgba(255,255,255,.30));
      font-weight:950;
      letter-spacing:.16em;
      text-transform:uppercase;
      font-size:11px;
      opacity:.95;
    }
    .statusDot{
      width:10px;height:10px;border-radius:999px;
      background: rgba(11,12,20,.35);
      box-shadow: 0 0 0 6px rgba(11,12,20,.06);
    }
    .statusDot.on{
      background: rgba(11,12,20,.78);
      box-shadow: 0 0 0 6px rgba(185,240,255,.18);
    }

    .signatureBox{
      border-radius: 22px;
      border: 1px dashed rgba(11,12,20,.22);
      background: rgba(255,255,255,.55);
      padding: 14px;
      position:relative;
      overflow:hidden;
    }
    .sigTop{
      display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;
      margin-bottom:10px;
    }
    .sigLabel{
      font-weight:950;
      letter-spacing:.16em;
      text-transform:uppercase;
      font-size:12px;
      opacity:.78;
    }
    .sigHint{
      color:var(--muted);
      font-weight:700;
      font-size:13px;
    }
    canvas#sig{
      width:100%;
      height:160px;
      display:block;
      border-radius: 16px;
      background: linear-gradient(180deg, rgba(255,255,255,.65), rgba(255,255,255,.30));
      border:1px solid rgba(255,255,255,.65);
      touch-action:none;
    }

    .stamp{
      position:absolute;
      right:16px;
      bottom:16px;
      transform: rotate(-12deg) scale(.9);
      padding:10px 12px;
      border-radius: 16px;
      border: 2px solid rgba(11,12,20,.75);
      background: rgba(255,255,255,.7);
      font-weight:1000;
      letter-spacing:.18em;
      text-transform:uppercase;
      opacity:0;
      pointer-events:none;
      filter: drop-shadow(0 18px 40px rgba(12,10,30,.14));
    }
    .stamp.on{
      opacity:1;
      animation: stampIn .35s ease-out both, glitch .9s ease-in-out .25s 2;
    }
    @keyframes stampIn{
      0%{ transform: rotate(-18deg) scale(1.25); opacity:0; }
      100%{ transform: rotate(-12deg) scale(.92); opacity:1; }
    }
    @keyframes glitch{
      0%{ transform: rotate(-12deg) translate(0,0) scale(.92); }
      20%{ transform: rotate(-12deg) translate(-2px,1px) scale(.92); }
      40%{ transform: rotate(-12deg) translate(2px,-1px) scale(.92); }
      60%{ transform: rotate(-12deg) translate(-1px,-2px) scale(.92); }
      80%{ transform: rotate(-12deg) translate(1px,2px) scale(.92); }
      100%{ transform: rotate(-12deg) translate(0,0) scale(.92); }
    }

    .locked{
      opacity:.35;
      filter: blur(.2px);
      pointer-events:none;
      transition: opacity .35s ease;
    }
    .locked.unlock{
      opacity:1;
      filter:none;
      pointer-events:auto;
    }

    /* ---------- MULTIPASS GENERATOR + OUTPUT ---------- */
    .formGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    @media (max-width: 940px){
      .formGrid{ grid-template-columns:1fr; }
    }
    .field{
      display:grid;
      gap:6px;
    }
    .field span{
      font-size:12px;
      letter-spacing:.18em;
      text-transform:uppercase;
      opacity:.72;
      font-weight:950;
    }
    .field input, .field select{
      padding:12px 12px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.70);
      background: linear-gradient(180deg, rgba(255,255,255,.78), rgba(255,255,255,.34));
      font-weight:900;
      outline:none;
      color: rgba(11,12,20,.88);
    }
    .field input::placeholder{ color: rgba(11,12,20,.45); }

    .meterRow{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center;
      margin-top:12px;
    }
    .meter{
      display:flex; align-items:center; gap:8px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.65);
      background: linear-gradient(180deg, rgba(255,255,255,.66), rgba(255,255,255,.32));
      font-weight:950;
      letter-spacing:.16em;
      text-transform:uppercase;
      font-size:11px;
      opacity:.95;
      user-select:none;
    }
    .bar{
      width:160px; height:8px;
      border-radius:999px;
      background: rgba(11,12,20,.10);
      overflow:hidden;
      border:1px solid rgba(255,255,255,.55);
    }
    .fill{
      height:100%;
      width:0%;
      border-radius:999px;
      background: linear-gradient(90deg, rgba(201,182,255,.9), rgba(185,240,255,.85), rgba(255,214,247,.85));
      transition: width .45s ease;
    }

    .result{
      margin-top:12px;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.65);
      background: rgba(255,255,255,.55);
      padding: 12px;
      color: rgba(11,12,20,.88);
      font-weight:800;
      line-height:1.45;
      display:none;
    }
    .result.on{ display:block; animation: pop .25s ease-out both; }
    @keyframes pop{
      from{ transform: translateY(6px); opacity:0; }
      to{ transform: translateY(0); opacity:1; }
    }

    .multipass{
      border-radius: 22px;
      border:1px solid rgba(255,255,255,.70);
      background: linear-gradient(180deg, rgba(255,255,255,.72), rgba(255,255,255,.30));
      padding: 14px;
      position:relative;
      overflow:hidden;
    }
    .multipass::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        linear-gradient(90deg, transparent 0%, rgba(185,240,255,.22) 35%, rgba(255,214,247,.20) 55%, transparent 100%);
      transform: translateX(-60%);
      animation: multipassScan 3.6s ease-in-out infinite;
      opacity:.7;
      mix-blend-mode: soft-light;
      pointer-events:none;
    }
    @keyframes multipassScan{
      0%{ transform: translateX(-60%); }
      55%{ transform: translateX(60%); }
      100%{ transform: translateX(-60%); }
    }
    .multipassTop{
      display:flex;
      gap:10px;
      justify-content:space-between;
      align-items:center;
      flex-wrap:wrap;
      margin-bottom:12px;
      position:relative;
      z-index:1;
    }
    .multipassGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      position:relative;
      z-index:1;
    }
    @media (max-width: 940px){
      .multipassGrid{ grid-template-columns:1fr; }
    }
    .mBlock{
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.68);
      background: rgba(255,255,255,.55);
      padding: 12px;
    }
    .mBlock b{
      display:block;
      font-size:12px;
      letter-spacing:.18em;
      text-transform:uppercase;
      opacity:.72;
      margin-bottom:8px;
      font-weight:1000;
    }
    .mRows{ display:grid; gap:8px; }
    .mRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:10px 10px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.65);
      background: linear-gradient(180deg, rgba(255,255,255,.70), rgba(255,255,255,.32));
      font-weight:900;
    }
    .mRow span{ opacity:.78; letter-spacing:.14em; text-transform:uppercase; font-size:11px; font-weight:950; }
    .mRow i{ font-style:normal; font-weight:950; }
    .mText{
      color: rgba(11,12,20,.78);
      font-weight:800;
      line-height:1.45;
    }

    /* MULTIPASS SEAL */
    .mpSeal{
      position:absolute;
      right:16px;
      bottom:16px;
      transform: rotate(-12deg) scale(.92);
      padding:12px 14px;
      border-radius: 18px;
      border:2px solid rgba(11,12,20,.78);
      background: rgba(255,255,255,.72);
      filter: drop-shadow(0 18px 40px rgba(12,10,30,.14));
      opacity:0;
      pointer-events:none;
      z-index:2;
    }
    .mpSeal.on{
      opacity:1;
      animation: sealIn .34s ease-out both, sealGlitch .9s ease-in-out .22s 2;
    }
    .mpSealTop{
      display:flex;
      gap:10px;
      justify-content:space-between;
      font-weight:1000;
      letter-spacing:.22em;
      text-transform:uppercase;
      font-size:11px;
      opacity:.9;
    }
    .mpSealMid{
      margin-top:6px;
      font-weight:1000;
      letter-spacing:.18em;
      text-transform:uppercase;
      font-size:12px;
    }
    .mpSealBot{
      margin-top:6px;
      font-weight:900;
      letter-spacing:.14em;
      text-transform:uppercase;
      font-size:10px;
      opacity:.75;
    }
    @keyframes sealIn{
      0%{ transform: rotate(-18deg) scale(1.18); opacity:0; }
      100%{ transform: rotate(-12deg) scale(.92); opacity:1; }
    }
    @keyframes sealGlitch{
      0%{ transform: rotate(-12deg) translate(0,0) scale(.92); }
      20%{ transform: rotate(-12deg) translate(-2px,1px) scale(.92); }
      40%{ transform: rotate(-12deg) translate(2px,-1px) scale(.92); }
      60%{ transform: rotate(-12deg) translate(-1px,-2px) scale(.92); }
      80%{ transform: rotate(-12deg) translate(1px,2px) scale(.92); }
      100%{ transform: rotate(-12deg) translate(0,0) scale(.92); }
    }

    footer{
      padding: 26px 0 40px;
      color: rgba(11,12,20,.55);
      text-align:center;
      font-weight:900;
      letter-spacing:.10em;
      text-transform:uppercase;
      font-size:12px;
    }
  </style>
</head>

<body>
  <div class="aurora" aria-hidden="true"></div>

  <header class="nav">
    <div class="wrap">
      <div class="brand">
        <div>ADM mode: <span style="opacity:.88">off script.</span></div>
        <small>new method</small>
      </div>

      <nav class="links">
        <a href="#manifest">manifest</a>
        <a href="#protocol">protocol</a>
        <a href="#multipassGate">multipass</a>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <!-- HERO (LIGHT, CLEAR) -->
    <section class="hero">
      <div class="iridescent-bg" aria-hidden="true"></div>

      <h1 class="title">
        <span class="shimmer">adm mode:</span><br/>
        <span class="shimmer">off script.</span>
      </h1>

      <p class="lead reveal">
        новый игровой метод сборки личности.<br/>
        <b>протокол</b> → <b>multipass</b> → <b>билд</b>.
      </p>

      <div class="chips reveal">
        <div class="chip">protocol</div>
        <div class="chip">multipass</div>
        <div class="chip">build</div>
        <div class="chip">access</div>
        <div class="chip">off script</div>
      </div>

      <div class="ctaRow reveal">
        <a class="btn primary" href="#protocol"><span>sign protocol →</span></a>
        <a class="btn ghost" href="#multipassGate"><span>generate multipass</span></a>
      </div>
    </section>

    <!-- MANIFEST -->
    <section class="grid" id="manifest">
      <article class="card reveal">
        <div class="inner">
          <div class="h2">manifest</div>
          <p class="manifest">
            Если система закрывает двери — я становлюсь дверью.<br/>
            Если система ставит границы — я становлюсь линией разрыва.<br/><br/>
            Я не прошу разрешения.<br/>
            Я создаю протокол.
          </p>
        </div>
      </article>

      <aside class="card reveal">
        <div class="inner">
          <div class="h2">rules</div>
          <ul class="list">
            <li class="item">
              <b>you <span class="tag">admin</span></b>
              <p>ты не NPC. ты — автор правил.</p>
            </li>
            <li class="item">
              <b>system <span class="tag">environment</span></b>
              <p>система — окружение. ты не обязан(а) ей соответствовать.</p>
            </li>
            <li class="item">
              <b>pressure <span class="tag">fuel</span></b>
              <p>давление конвертируется в броню и действие.</p>
            </li>
            <li class="item">
              <b>gates <span class="tag">protocol → multipass</span></b>
              <p>сначала подпись. потом доступ к генерации.</p>
            </li>
          </ul>
        </div>
      </aside>
    </section>

    <!-- PROTOCOL SIGNING -->
    <section class="card reveal" id="protocol" style="margin-bottom:18px;">
      <div class="inner">
        <div class="h2">protocol signing</div>

        <div class="protocolPanel">
          <div class="console">
            <div class="row">
              <div class="kv"><span class="statusDot" id="dot"></span> access: <span id="accessTxt">locked</span></div>
              <div class="pill">adm mode: off script</div>
            </div>
            <div style="margin-top:8px; color:var(--muted); font-weight:750; line-height:1.5;">
              нарисуй подпись → нажми <b>confirm</b> → откроется MULTIPASS генерация.
            </div>
          </div>

          <div class="signatureBox">
            <div class="sigTop">
              <div class="sigLabel">signature input</div>
              <div class="sigHint">touch / mouse</div>
            </div>

            <canvas id="sig"></canvas>
            <div class="stamp" id="stamp">signed</div>

            <div class="ctaRow" style="margin:12px 0 0;">
              <button class="btn" id="clearBtn" type="button"><span>clear</span></button>
              <button class="btn primary" id="confirmBtn" type="button"><span>confirm</span></button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- MULTIPASS GATE -->
    <section class="card reveal locked" id="multipassGate" style="margin-bottom:18px;">
      <div class="inner">
        <div class="h2">multipass generator</div>

        <p class="lead" style="margin:0 0 10px;">
          вводишь дату рождения → система собирает билд → печать MULTIPASS выдаёт доступ.
        </p>

        <div class="formGrid">
          <label class="field">
            <span>date (calendar)</span>
            <input id="birthDate" type="date" />
          </label>

          <label class="field">
            <span>time</span>
            <input id="birthTime" type="time" value="01:30" />
          </label>

          <label class="field" style="grid-column: 1 / -1;">
            <span>origin (city)</span>
            <input id="birthCity" type="text" placeholder="например: Нальчик, Россия" />
          </label>

          <label class="field" style="grid-column: 1 / -1;">
            <span>scan mode</span>
            <select id="engineMode">
              <option value="strict">strict scan</option>
              <option value="myth">myth scan</option>
              <option value="hard">hardcore off-script</option>
            </select>
          </label>
        </div>

        <div class="ctaRow" style="margin:12px 0 0;">
          <button class="btn" id="prefillMe" type="button"><span>load my data</span></button>
          <button class="btn primary" id="genMultipassBtn" type="button"><span>generate multipass</span></button>
        </div>

        <div class="meterRow">
          <div class="meter">engine: <span id="engineStatus">standby</span></div>
          <div class="meter">build meter
            <span class="bar"><span class="fill" id="buildFill"></span></span>
            <span id="buildPct">0%</span>
          </div>
        </div>

        <div class="result" id="genLog"></div>

        <!-- MULTIPASS OUTPUT -->
        <div class="multipass locked" id="multipass" style="margin-top:14px;">
          <div class="multipassTop">
            <div class="pill" id="mpId">ID: ADM-0000</div>
            <div class="pill" id="mpClearance">CLEARANCE: UNKNOWN</div>
            <div class="pill" id="mpOrigin">ORIGIN: —</div>
            <div class="pill" id="mpSeed">SEED: —</div>
          </div>

          <div class="multipassGrid">
            <div class="mBlock">
              <b>core stats</b>
              <div class="mRows" id="statRows"></div>
            </div>

            <div class="mBlock">
              <b>loadout</b>
              <div class="mText" id="loadoutText"></div>
            </div>

            <div class="mBlock">
              <b>main directive</b>
              <div class="mText" id="directiveText"></div>
            </div>

            <div class="mBlock">
              <b>route (7 days)</b>
              <div class="mRows" id="routeRows"></div>
            </div>
          </div>

          <div class="mpSeal" id="mpSeal">
            <div class="mpSealTop">
              <span class="mpSealWord">MULTIPASS</span>
              <span class="mpSealWord">AUTH</span>
            </div>
            <div class="mpSealMid">ACCESS GRANTED</div>
            <div class="mpSealBot" id="mpSealLine">SEAL: PENDING</div>
          </div>
        </div>
      </div>
    </section>

    <footer class="reveal">
      ADM MODE: OFF SCRIPT • PROTOCOL → MULTIPASS → BUILD
    </footer>
  </main>

  <script>
    // reveal on scroll
    const els = Array.from(document.querySelectorAll('.reveal'));
    const io = new IntersectionObserver((entries) => {
      entries.forEach(e => { if(e.isIntersecting) e.target.classList.add('on'); });
    }, { threshold: 0.12 });
    els.forEach(el => io.observe(el));

    // ---------- SIGNATURE CANVAS ----------
    const canvas = document.getElementById('sig');
    const ctx = canvas.getContext('2d');

    function resizeCanvas(){
      const rect = canvas.getBoundingClientRect();
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      canvas.width = Math.floor(rect.width * dpr);
      canvas.height = Math.floor(rect.height * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0);

      ctx.lineCap = 'round';
      ctx.lineJoin = 'round';
      ctx.lineWidth = 2.6;
      ctx.strokeStyle = 'rgba(11,12,20,.78)';

      ctx.clearRect(0,0,rect.width,rect.height);

      // guide line
      ctx.strokeStyle = 'rgba(11,12,20,.10)';
      ctx.lineWidth = 1;
      ctx.beginPath();
      ctx.moveTo(14, rect.height - 32);
      ctx.lineTo(rect.width - 14, rect.height - 32);
      ctx.stroke();

      ctx.strokeStyle = 'rgba(11,12,20,.78)';
      ctx.lineWidth = 2.6;
    }
    window.addEventListener('resize', resizeCanvas, {passive:true});
    requestAnimationFrame(resizeCanvas);

    let drawing = false;
    let hasInk = false;

    function getPos(e){
      const rect = canvas.getBoundingClientRect();
      const touch = e.touches && e.touches[0];
      const clientX = touch ? touch.clientX : e.clientX;
      const clientY = touch ? touch.clientY : e.clientY;
      return { x: clientX - rect.left, y: clientY - rect.top };
    }

    function start(e){
      drawing = true;
      const p = getPos(e);
      ctx.beginPath();
      ctx.moveTo(p.x, p.y);
      hasInk = true;
      e.preventDefault?.();
    }
    function move(e){
      if(!drawing) return;
      const p = getPos(e);
      ctx.lineTo(p.x, p.y);
      ctx.stroke();
      e.preventDefault?.();
    }
    function end(){ drawing = false; }

    canvas.addEventListener('mousedown', start);
    canvas.addEventListener('mousemove', move);
    window.addEventListener('mouseup', end);

    canvas.addEventListener('touchstart', start, {passive:false});
    canvas.addEventListener('touchmove', move, {passive:false});
    window.addEventListener('touchend', end);

    const clearBtn = document.getElementById('clearBtn');
    const confirmBtn = document.getElementById('confirmBtn');
    const stamp = document.getElementById('stamp');
    const dot = document.getElementById('dot');
    const accessTxt = document.getElementById('accessTxt');

    const multipassGate = document.getElementById('multipassGate');
    const engineStatus = document.getElementById('engineStatus');

    function lockSection(section, lock){
      if(!section) return;
      if(lock){
        section.classList.add('locked');
        section.classList.remove('unlock');
      }else{
        section.classList.add('unlock');
        section.classList.remove('locked');
      }
    }
    lockSection(multipassGate, true);

    function onProtocolSigned(){
      lockSection(multipassGate, false);
      if(engineStatus) engineStatus.textContent = "online";
    }

    clearBtn.addEventListener('click', ()=>{
      resizeCanvas();
      stamp.classList.remove('on');
      dot.classList.remove('on');
      accessTxt.textContent = 'locked';
      lockSection(multipassGate, true);
      if(engineStatus) engineStatus.textContent = "standby";
      hasInk = false;
    });

    confirmBtn.addEventListener('click', ()=>{
      if(!hasInk){
        confirmBtn.animate([
          { transform:'translateX(0)' },
          { transform:'translateX(-3px)' },
          { transform:'translateX(3px)' },
          { transform:'translateX(0)' },
        ], { duration: 240, iterations: 1 });
        return;
      }
      stamp.classList.add('on');
      dot.classList.add('on');
      accessTxt.textContent = 'granted';
      onProtocolSigned();
      setTimeout(()=> multipassGate.scrollIntoView({ behavior:'smooth', block:'start' }), 380);
    });

    // ---------- MULTIPASS GENERATOR ----------
    const birthDate = document.getElementById('birthDate');
    const birthTime = document.getElementById('birthTime');
    const birthCity = document.getElementById('birthCity');
    const engineMode = document.getElementById('engineMode');

    const prefillMe = document.getElementById('prefillMe');
    const genBtn = document.getElementById('genMultipassBtn');
    const genLog = document.getElementById('genLog');

    const buildFill = document.getElementById('buildFill');
    const buildPct = document.getElementById('buildPct');

    const multipass = document.getElementById('multipass');
    const mpId = document.getElementById('mpId');
    const mpClearance = document.getElementById('mpClearance');
    const mpOrigin = document.getElementById('mpOrigin');
    const mpSeed = document.getElementById('mpSeed');

    const statRows = document.getElementById('statRows');
    const loadoutText = document.getElementById('loadoutText');
    const directiveText = document.getElementById('directiveText');
    const routeRows = document.getElementById('routeRows');

    const mpSeal = document.getElementById('mpSeal');
    const mpSealLine = document.getElementById('mpSealLine');

    function showLog(text){
      if(!genLog) return;
      genLog.textContent = text;
      genLog.classList.add('on');
    }

    // your birth data prefill
    prefillMe?.addEventListener('click', ()=>{
      if(birthDate) birthDate.value = "1996-08-01";
      if(birthTime) birthTime.value = "01:30";
      if(birthCity) birthCity.value = "Нальчик, Россия";
      showLog("SYSTEM: input loaded.");
    });

    function sumDigits(str){
      return (str || "").replace(/\D/g,'').split('').reduce((a,c)=>a + (c.charCodeAt(0)-48), 0);
    }
    function clamp(n,min,max){ return Math.max(min, Math.min(max,n)); }

    function computeBuildMeter(stats){
      // 4 stats, each 1..15 => max 60
      const total = stats.autonomy + stats.rage + stats.clarity + stats.armor;
      return clamp(Math.round((total / 60) * 100), 0, 100);
    }

    function generateMultipass({dateStr, timeStr, cityStr, mode}){
      const dsum = sumDigits(dateStr);
      const tsum = sumDigits(timeStr);
      const csum = sumDigits(cityStr);
      const seed = dsum + tsum + csum;

      let autonomy = (seed % 10) + 5;
      let rage = ((seed * 3) % 10) + 3;
      let clarity = ((seed * 5) % 10) + 4;
      let armor = ((seed * 7) % 10) + 4;

      if(mode === "strict"){ clarity += 2; }
      if(mode === "myth"){ armor += 1; autonomy += 1; }
      if(mode === "hard"){ rage += 2; autonomy += 1; }

      autonomy = clamp(autonomy, 1, 15);
      rage = clamp(rage, 1, 15);
      clarity = clamp(clarity, 1, 15);
      armor = clamp(armor, 1, 15);

      const loadouts = [
        { name:"LOADOUT: ARCHITECT", line:"ты переписываешь карту. правила создаются тобой." },
        { name:"LOADOUT: SHIELD", line:"давление → броня. контроль снаружи включает твою силу." },
        { name:"LOADOUT: OPERATOR", line:"ты выигрываешь тишиной. точность выше эмоций." },
        { name:"LOADOUT: WRAITH", line:"ты исчезаешь из чужих сценариев и входишь только по своим условиям." },
      ];
      const lo = loadouts[seed % loadouts.length];

      const directives = [
        "MAIN DIRECTIVE: собрать протокол автономности и держать его без отката.",
        "MAIN DIRECTIVE: конвертировать давление в действие и границы.",
        "MAIN DIRECTIVE: закрыть доступ системе к твоему времени и голосу.",
        "MAIN DIRECTIVE: собрать броню свободы: правило, граница, дисциплина.",
      ];
      const directive = directives[(seed + 1) % directives.length];

      const route = [
        { k:"DAY 1", v:"SCAN: damage log → 3 скрипта, которые тебя выключают." },
        { k:"DAY 2", v:"PURGE: 1 триггер → удалить контакт/привычку/шум." },
        { k:"DAY 3", v:"ARMOR: 1 граница → держать 24h без отката." },
        { k:"DAY 4", v:"OFF SCRIPT: 1 действие → поступок вне старой роли." },
        { k:"DAY 5", v:"CHOICE: один риск ради результата." },
        { k:"DAY 6", v:"PATCH: фиксация → что стало сильнее/чище." },
        { k:"DAY 7", v:"BOSS CHECK: тест → там, где раньше сдавал(а) позиции." },
      ];

      const clearance =
        (autonomy + armor >= rage + clarity) ? "CLEARANCE: ARMOR/AUTONOMY" : "CLEARANCE: RAGE/CLARITY";

      const id = `ID: ADM-${String(seed).padStart(4,'0')}`;

      return {
        seed,
        id,
        clearance,
        origin: cityStr,
        stats: { autonomy, rage, clarity, armor },
        loadout: lo,
        directive,
        route
      };
    }

    function renderMultipass(mp){
      multipass.classList.remove('locked');
      multipass.classList.add('unlock');

      mpId.textContent = mp.id;
      mpClearance.textContent = mp.clearance;
      mpOrigin.textContent = `ORIGIN: ${mp.origin}`;
      mpSeed.textContent = `SEED: ${mp.seed}`;

      statRows.innerHTML = [
        {k:"autonomy", v: mp.stats.autonomy},
        {k:"rage", v: mp.stats.rage},
        {k:"clarity", v: mp.stats.clarity},
        {k:"armor", v: mp.stats.armor},
      ].map(s => `<div class="mRow"><span>${s.k}</span><i>${s.v}/15</i></div>`).join("");

      loadoutText.textContent = `${mp.loadout.name}: ${mp.loadout.line}`;
      directiveText.textContent = mp.directive;

      routeRows.innerHTML = mp.route.map(r =>
        `<div class="mRow"><span>${r.k}</span><i>${r.v}</i></div>`
      ).join("");

      // build meter
      const pct = computeBuildMeter(mp.stats);
      buildFill.style.width = `${pct}%`;
      buildPct.textContent = `${pct}%`;

      // SEAL / STAMP
      if(mpSealLine) mpSealLine.textContent = `SEAL: ${mp.id.replace('ID: ','')} • ${mp.clearance.replace('CLEARANCE: ','')}`;
      if(mpSeal){
        mpSeal.classList.remove('on');
        void mpSeal.offsetWidth; // re-trigger animation
        mpSeal.classList.add('on');
      }
    }

    genBtn?.addEventListener('click', ()=>{
      const ds = birthDate?.value || "";
      const ts = birthTime?.value || "";
      const cs = birthCity?.value || "";
      const mode = engineMode?.value || "strict";

      if(!ds || !ts || !cs){
        showLog("ERROR: date + time + origin required.");
        genBtn.animate([{transform:'translateX(0)'},{transform:'translateX(-3px)'},{transform:'translateX(3px)'},{transform:'translateX(0)'}],{duration:240});
        return;
      }

      const mp = generateMultipass({dateStr: ds, timeStr: ts, cityStr: cs, mode});
      showLog("SYSTEM: MULTIPASS generated. access granted.");
      renderMultipass(mp);

      setTimeout(()=> multipass.scrollIntoView({behavior:'smooth', block:'start'}), 220);
    });
  </script>
</body>
</html>
