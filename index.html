<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ADM MODE ‚Äî —Å–∫–∞–Ω –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</title>
  <meta name="description" content="ADM MODE ‚Äî —Å–∫–∞–Ω –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –ø–æ –¥–∞—Ç–µ —Ä–æ–∂–¥–µ–Ω–∏—è." />

  <!-- Export libs (PNG/PDF) -->
  <script defer src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

  <style>
    :root{
      --bg0:#f7fbff; --bg1:#eef6ff;
      --glass: rgba(255,255,255,.66);
      --glass2: rgba(255,255,255,.42);
      --stroke: rgba(20, 60, 90, .10);
      --ink: #0c1b2a;
      --muted: rgba(12,27,42,.68);

      --brand: #19d3ff;
      --brand2:#7c5cff;

      --shadow: 0 28px 90px rgba(6,22,44,.18);
      --shadow2: 0 18px 55px rgba(6,22,44,.14);

      --r: 22px; --r2: 28px;
      --ease: cubic-bezier(.2,.9,.2,1);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--ink);
      background:
        radial-gradient(1200px 800px at 15% 10%, rgba(25,211,255,.20), transparent 60%),
        radial-gradient(900px 700px at 90% 0%, rgba(124,92,255,.14), transparent 55%),
        radial-gradient(900px 700px at 70% 90%, rgba(25,211,255,.12), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
    }
    body::before{
      content:"";
      position:fixed; inset:0;
      pointer-events:none;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='260' height='260'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='260' height='260' filter='url(%23n)' opacity='.13'/%3E%3C/svg%3E");
      mix-blend-mode:multiply;
      opacity:.28;
      z-index:0;
    }
    .wrap{ position:relative; z-index:1; }

    /* Topbar */
    .topbar{
      position:sticky; top:0; z-index:50;
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      background: linear-gradient(180deg, rgba(255,255,255,.72), rgba(255,255,255,.40));
      border-bottom: 1px solid var(--stroke);
    }
    .topbar .inner{
      max-width:1120px; margin:0 auto;
      padding:14px 18px;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      letter-spacing:.12em; text-transform:uppercase;
      font-weight:900; font-size:12px;
      color: rgba(12,27,42,.82);
    }
    .dot{
      width:10px; height:10px; border-radius:999px;
      background:
        radial-gradient(circle at 30% 30%, #fff, rgba(255,255,255,.2) 35%),
        linear-gradient(135deg, var(--brand), var(--brand2));
      box-shadow: 0 0 0 6px rgba(25,211,255,.12);
      animation: pulse 2.6s var(--ease) infinite;
    }
    @keyframes pulse{
      0%,100%{ transform:scale(1); box-shadow:0 0 0 6px rgba(25,211,255,.12); }
      50%{ transform:scale(1.08); box-shadow:0 0 0 10px rgba(25,211,255,.08); }
    }

    .btn{
      border:1px solid rgba(25,211,255,.28);
      background: linear-gradient(180deg, rgba(255,255,255,.78), rgba(255,255,255,.35));
      border-radius:999px;
      padding:10px 14px;
      font-size:13px;
      display:inline-flex; align-items:center; gap:10px;
      box-shadow: 0 14px 40px rgba(6,22,44,.10);
      transition: transform .25s var(--ease), box-shadow .25s var(--ease);
      cursor:pointer; user-select:none; white-space:nowrap;
    }
    .btn:hover{ transform: translateY(-1px); box-shadow: 0 18px 55px rgba(6,22,44,.14); }
    .btn:active{ transform: translateY(0px) scale(.99); }
    .btn.primary{
      border:1px solid rgba(25,211,255,.42);
      background:
        radial-gradient(140px 80px at 25% 25%, rgba(25,211,255,.30), transparent 60%),
        linear-gradient(135deg, rgba(25,211,255,.18), rgba(124,92,255,.14)),
        linear-gradient(180deg, rgba(255,255,255,.76), rgba(255,255,255,.30));
    }

    /* Layout */
    .hero{
      max-width:1120px; margin:0 auto;
      padding:52px 18px 28px;
      display:grid;
      grid-template-columns: 1.25fr .75fr;
      gap:18px;
      align-items:stretch;
    }
    @media (max-width: 980px){
      .hero{ grid-template-columns:1fr; padding-top:32px; }
    }

    .card{
      border: 1px solid var(--stroke);
      border-radius: var(--r2);
      background: linear-gradient(180deg, var(--glass), rgba(255,255,255,.38));
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
      box-shadow: var(--shadow);
      position:relative; overflow:hidden;
    }
    .card::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(800px 240px at 20% 0%, rgba(25,211,255,.16), transparent 60%),
        radial-gradient(700px 250px at 80% 15%, rgba(124,92,255,.10), transparent 55%),
        linear-gradient(180deg, rgba(255,255,255,.40), rgba(255,255,255,0));
      pointer-events:none;
    }

    .heroMain{ padding:26px 24px; }
    .kicker{
      font-size:12px; letter-spacing:.18em;
      text-transform:uppercase; color: rgba(12,27,42,.56);
      display:flex; flex-wrap:wrap; gap:8px;
    }
    .chip{
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(12,27,42,.10);
      background: rgba(255,255,255,.55);
    }

    .title{
      margin:14px 0 8px;
      font-size: clamp(36px, 4.2vw, 62px);
      line-height:1.02;
      letter-spacing:-.03em;
    }
    .adm{
      display:inline-block;
      position:relative;
      padding:4px 10px 6px;
      margin-left:-10px;
      border-radius: 16px;
      background:
        radial-gradient(220px 90px at 20% 30%, rgba(25,211,255,.28), transparent 60%),
        radial-gradient(240px 90px at 80% 30%, rgba(124,92,255,.14), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,.68), rgba(255,255,255,.25));
      border: 1px solid rgba(25,211,255,.24);
      box-shadow: 0 18px 50px rgba(6,22,44,.10);
      overflow:hidden;
    }
    .adm::after{
      content:"";
      position:absolute; inset:-40px;
      background: linear-gradient(120deg, transparent 0%, rgba(255,255,255,0) 40%, rgba(255,255,255,.55) 50%, rgba(255,255,255,0) 60%, transparent 100%);
      transform: translateX(-60%) rotate(8deg);
      animation: shine 4.2s var(--ease) infinite;
      opacity:.9;
      pointer-events:none;
    }
    @keyframes shine{
      0%{ transform: translateX(-70%) rotate(8deg); opacity:.0; }
      18%{ opacity:.85; }
      42%{ transform: translateX(70%) rotate(8deg); opacity:.0; }
      100%{ transform: translateX(70%) rotate(8deg); opacity:.0; }
    }

    .sub{
      margin: 0 0 14px;
      font-size: 15px; line-height:1.55;
      color: var(--muted);
      max-width: 62ch;
    }

    .manifest{
      margin-top:14px;
      padding:14px;
      border-radius: 18px;
      border: 1px dashed rgba(12,27,42,.16);
      background: rgba(255,255,255,.46);
      color: rgba(12,27,42,.78);
      font-size:14px; line-height:1.5;
      position:relative; overflow:hidden;
    }
    .manifest .label{
      font-size:11px; letter-spacing:.16em;
      text-transform:uppercase; color: rgba(12,27,42,.52);
      margin-bottom:8px;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
    }
    .manifest .sig{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Courier New", monospace;
      font-size:11px; color: rgba(12,27,42,.55);
      white-space:nowrap;
    }

    /* Scanner */
    .scanner{ padding:18px; display:flex; flex-direction:column; gap:12px; }
    .scannerTop{ display:flex; align-items:flex-start; justify-content:space-between; gap:10px; }
    .scannerTop h3{
      margin:0; font-size:12px;
      letter-spacing:.18em; text-transform:uppercase;
      color: rgba(12,27,42,.68);
    }
    .status{
      font-size:12px; color: rgba(12,27,42,.56);
      display:flex; gap:8px; align-items:center;
      white-space:nowrap;
    }
    .led{
      width:8px; height:8px; border-radius:999px;
      background: rgba(12,27,42,.18);
      box-shadow: 0 0 0 4px rgba(12,27,42,.06);
    }
    .led.live{
      background:
        radial-gradient(circle at 30% 30%, #fff, rgba(255,255,255,.25) 35%),
        linear-gradient(135deg, var(--brand), var(--brand2));
      box-shadow: 0 0 0 6px rgba(25,211,255,.10), 0 0 22px rgba(25,211,255,.28);
      animation: blink 1.4s var(--ease) infinite;
    }
    @keyframes blink{ 0%,100%{ filter:saturate(1); } 50%{ filter:saturate(1.25) brightness(1.04); } }

    .fieldRow{ display:grid; grid-template-columns: 1fr 1fr; gap:10px; }
    @media (max-width: 520px){ .fieldRow{ grid-template-columns:1fr; } }

    .field{
      padding:12px;
      border-radius:16px;
      border:1px solid rgba(12,27,42,.10);
      background: rgba(255,255,255,.58);
      display:flex; flex-direction:column; gap:8px;
    }
    .field label{
      font-size:11px; letter-spacing:.14em;
      text-transform:uppercase;
      color: rgba(12,27,42,.52);
    }
    .field input{
      border:none; outline:none;
      font-size:14px;
      background:transparent;
      color: rgba(12,27,42,.92);
      padding:0;
    }

    .scanPane{
      position:relative;
      border-radius: 18px;
      border:1px solid rgba(12,27,42,.10);
      background:
        radial-gradient(420px 180px at 15% 10%, rgba(25,211,255,.18), transparent 60%),
        radial-gradient(420px 180px at 85% 20%, rgba(124,92,255,.14), transparent 60%),
        rgba(255,255,255,.52);
      overflow:hidden;
      height: 150px;
    }
    .scanGrid{
      position:absolute; inset:0;
      background-image:
        linear-gradient(to right, rgba(12,27,42,.06) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(12,27,42,.06) 1px, transparent 1px);
      background-size: 22px 22px;
      opacity:.55;
      mask-image: radial-gradient(circle at 30% 40%, black 0 55%, transparent 75%);
    }
    .scanLine{
      position:absolute; left:-20%; right:-20%;
      height:2px;
      top:-10%;
      background: linear-gradient(90deg, transparent, rgba(25,211,255,.95), transparent);
      box-shadow: 0 0 18px rgba(25,211,255,.50);
      opacity:0;
      transform: rotate(-7deg);
    }
    .scanPulse{
      position:absolute; inset:-40px;
      background: radial-gradient(circle at 30% 40%, rgba(25,211,255,.18), transparent 62%);
      opacity:.85;
      filter: blur(2px);
      animation: float 6.5s var(--ease) infinite;
    }
    @keyframes float{
      0%,100%{ transform: translate3d(0,0,0) scale(1); }
      50%{ transform: translate3d(8px,-10px,0) scale(1.02); }
    }
    .scanning .scanLine{ opacity:1; animation: scan 1.35s var(--ease) infinite; }
    @keyframes scan{
      0%{ top:-20%; opacity:0; }
      12%{ opacity:1; }
      50%{ top:55%; opacity:1; }
      88%{ opacity:1; }
      100%{ top:120%; opacity:0; }
    }

    .miniHint{
      font-size:12px; color: rgba(12,27,42,.56);
      line-height:1.45; margin-top:2px;
    }

    /* Terminal */
    .terminal{
      max-width:1120px; margin:0 auto;
      padding: 0 18px 34px;
    }
    .panel{
      border-radius: 26px;
      border:1px solid rgba(12,27,42,.10);
      background: rgba(255,255,255,.52);
      box-shadow: var(--shadow2);
      overflow:hidden;
      position:relative;
    }
    .panelHead{
      padding:14px;
      display:flex; justify-content:space-between; align-items:center; gap:10px;
      border-bottom: 1px solid rgba(12,27,42,.10);
    }
    .panelTitle{
      font-size:12px;
      letter-spacing:.18em;
      text-transform:uppercase;
      font-weight:900;
      color: rgba(12,27,42,.70);
      display:flex; align-items:center; gap:10px;
    }
    .lights{ display:flex; gap:8px; }
    .lights span{ width:10px; height:10px; border-radius:999px; background: rgba(12,27,42,.14); }
    .lights span:nth-child(1){ background: rgba(25,211,255,.35); }
    .lights span:nth-child(2){ background: rgba(124,92,255,.25); }
    .lights span:nth-child(3){ background: rgba(12,27,42,.14); }
    .panelBody{ padding:14px; }
    .log{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Courier New", monospace;
      font-size:12px;
      line-height:1.6;
      color: rgba(12,27,42,.78);
      margin:0;
      white-space:pre-wrap;
    }
    .log .muted{ color: rgba(12,27,42,.52); }
    .log .ok{ color: rgba(0,120,120,.85); }
    .log .warn{ color: rgba(124,92,255,.85); }

    .paybox{
      margin-top:12px;
      padding:12px;
      border-radius: 18px;
      border:1px solid rgba(25,211,255,.20);
      background:
        radial-gradient(260px 120px at 20% 20%, rgba(25,211,255,.18), transparent 60%),
        radial-gradient(260px 120px at 80% 25%, rgba(124,92,255,.12), transparent 60%),
        rgba(255,255,255,.56);
    }
    .paybox h4{ margin:0 0 6px; font-size:14px; }
    .paybox p{ margin:0 0 10px; font-size:12px; color: rgba(12,27,42,.62); line-height:1.45; }

    /* Modal */
    .modalBack{
      position:fixed; inset:0;
      background: rgba(5, 18, 34, .28);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:100;
      padding:16px;
    }
    .modalBack.show{ display:flex; }

    .modal{
      width:min(1180px, 100%);
      border-radius: 28px;
      border:1px solid rgba(255,255,255,.30);
      background:
        radial-gradient(1000px 500px at 20% 0%, rgba(25,211,255,.20), transparent 60%),
        radial-gradient(1000px 500px at 90% 10%, rgba(124,92,255,.18), transparent 55%),
        linear-gradient(180deg, rgba(255,255,255,.78), rgba(255,255,255,.45));
      box-shadow: 0 55px 140px rgba(6,22,44,.35);
      overflow:hidden;
      position:relative;
      transform: translateY(8px);
      opacity:0;
      animation: modalIn .35s var(--ease) forwards;
    }
    @keyframes modalIn{
      to{ transform: translateY(0); opacity:1; }
    }
    .modalHead{
      padding:14px 16px;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      border-bottom:1px solid rgba(12,27,42,.10);
    }
    .modalTitle{
      display:flex; align-items:center; gap:10px;
      font-size:12px; letter-spacing:.18em; text-transform:uppercase;
      color: rgba(12,27,42,.70);
      font-weight:900;
    }
    .close{
      border:1px solid rgba(12,27,42,.12);
      background: rgba(255,255,255,.60);
      border-radius: 999px;
      padding:8px 10px;
      cursor:pointer;
      font-size:13px;
      white-space:nowrap;
    }
    .modalBody{
      padding:16px;
      display:grid;
      grid-template-columns: .95fr 1.05fr;
      gap:14px;
    }
    @media (max-width: 980px){ .modalBody{ grid-template-columns:1fr; } }

    /* Cards */
    .stack{ display:grid; gap:12px; }

    .pass{
      border-radius: 26px;
      border:1px solid rgba(12,27,42,.10);
      background:
        linear-gradient(135deg, rgba(255,255,255,.80), rgba(255,255,255,.40)),
        radial-gradient(900px 360px at 20% 0%, rgba(25,211,255,.18), transparent 60%),
        radial-gradient(900px 360px at 80% 10%, rgba(124,92,255,.14), transparent 60%);
      box-shadow: var(--shadow2);
      overflow:hidden;
      position:relative;
    }
    .pass::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        linear-gradient(90deg, rgba(12,27,42,.06) 1px, transparent 1px),
        linear-gradient(0deg, rgba(12,27,42,.06) 1px, transparent 1px);
      background-size: 26px 26px;
      opacity:.28;
      mask-image: radial-gradient(circle at 30% 30%, black 0 55%, transparent 78%);
      pointer-events:none;
    }

    .seal{
      width:84px; height:84px; border-radius:999px;
      position:relative;
      background:
        radial-gradient(circle at 30% 25%, rgba(255,255,255,.9), rgba(255,255,255,.25) 35%, rgba(255,255,255,.0) 65%),
        conic-gradient(from 120deg, rgba(25,211,255,.55), rgba(124,92,255,.40), rgba(25,211,255,.55));
      box-shadow: 0 18px 55px rgba(6,22,44,.16), 0 0 0 10px rgba(25,211,255,.08);
      filter: saturate(1.05);
      transition: transform .35s var(--ease);
    }
    .seal::before{
      content:"";
      position:absolute; inset:10px;
      border-radius:999px;
      border:1px dashed rgba(255,255,255,.72);
      opacity:.9;
    }
    .seal::after{
      content:"STAMP";
      position:absolute; inset:0;
      display:grid; place-items:center;
      font-size:11px; letter-spacing:.20em;
      font-weight:900;
      color: rgba(12,27,42,.72);
      text-transform:uppercase;
      transform: rotate(-12deg);
      text-shadow: 0 1px 0 rgba(255,255,255,.55);
    }

    /* Rarity */
    .rarityBadge{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(12,27,42,.10);
      background: rgba(255,255,255,.60);
      font-size:12px;
      color: rgba(12,27,42,.72);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      white-space:nowrap;
    }
    .rarityDot{
      width:10px; height:10px; border-radius:999px;
      background: linear-gradient(135deg, var(--brand), var(--brand2));
      box-shadow: 0 0 0 6px rgba(25,211,255,.10);
    }
    .rarityCommon .rarityDot{ box-shadow:0 0 0 6px rgba(12,27,42,.06); filter:saturate(.9); }
    .rarityRare .rarityDot{ box-shadow:0 0 0 6px rgba(25,211,255,.10); }
    .rarityEpic .rarityDot{ box-shadow:0 0 0 7px rgba(124,92,255,.10); }
    .rarityMythic .rarityDot{ box-shadow:0 0 0 8px rgba(255,200,80,.12); filter:saturate(1.2) brightness(1.05); }

    /* Mini card */
    .mini{
      padding:14px;
      display:grid;
      grid-template-columns: 92px 1fr;
      gap:12px;
      align-items:stretch;
      min-height: 180px;
    }
    .miniHead{
      grid-column: 1 / -1;
      display:flex; justify-content:space-between; align-items:flex-start; gap:10px;
      margin-bottom:2px;
    }
    .miniHead .t{ display:flex; flex-direction:column; gap:6px; }
    .miniHead .t1{
      font-size:12px; font-weight:900;
      letter-spacing:.18em; text-transform:uppercase;
      color: rgba(12,27,42,.70);
    }
    .miniHead .t2{
      font-size:12px; color: rgba(12,27,42,.58);
      letter-spacing:.12em; text-transform:uppercase;
      display:flex; align-items:center; gap:8px; flex-wrap:wrap;
    }
    .miniHead .t2 b{ color: rgba(12,27,42,.85); }

    .avatarFace{
      width:92px; height:110px;
      border-radius:18px;
      overflow:hidden;
      border:1px solid rgba(12,27,42,.12);
      background: rgba(255,255,255,.60);
      position:relative;
    }
    .avatarFace img{
      width:100%; height:100%;
      object-fit:cover;
      object-position: 50% 25%;
      transform: scale(1.08);
      display:block;
      filter: saturate(1.02) contrast(1.02);
    }
    .miniInfo{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      align-content:start;
    }
    .kv{
      padding:10px;
      border-radius: 16px;
      border:1px solid rgba(12,27,42,.10);
      background: rgba(255,255,255,.56);
      position:relative;
      overflow:hidden;
    }
    .kv .k{
      font-size:10px;
      letter-spacing:.18em;
      text-transform:uppercase;
      color: rgba(12,27,42,.55);
      margin-bottom:6px;
    }
    .kv .v{
      font-size:14px;
      color: rgba(12,27,42,.90);
      font-weight:800;
      word-break:break-word;
    }
    .miniFoot{
      grid-column: 1 / -1;
      display:flex; justify-content:space-between; align-items:center; gap:10px;
      border-top:1px solid rgba(12,27,42,.10);
      padding-top:10px;
      margin-top:2px;
      font-size:12px;
      color: rgba(12,27,42,.62);
    }
    .protoSig{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Courier New", monospace;
      letter-spacing:.06em;
      white-space:nowrap;
    }

    /* Full card */
    .full{ padding:14px; display:grid; gap:12px; }
    .fullTop{
      display:flex; justify-content:space-between; align-items:flex-start; gap:12px;
    }
    .fullTop .ttl{ display:flex; flex-direction:column; gap:6px; }
    .fullTop .ttl .t1{
      font-size:12px; font-weight:900;
      letter-spacing:.18em; text-transform:uppercase;
      color: rgba(12,27,42,.70);
      display:flex; gap:10px; align-items:center; flex-wrap:wrap;
    }
    .fullTop .ttl .t2{
      font-size:22px; letter-spacing:-.02em;
      font-weight:900;
      color: rgba(12,27,42,.92);
    }

    .fullBody{
      display:grid;
      grid-template-columns: 1fr 1.2fr;
      gap:12px;
      align-items:stretch;
    }
    @media (max-width: 520px){ .fullBody{ grid-template-columns:1fr; } }

    .avatarFull{
      border-radius: 22px;
      overflow:hidden;
      border:1px solid rgba(12,27,42,.12);
      background: rgba(255,255,255,.60);
      min-height: 320px;
      position:relative;
    }
    .avatarFull img{
      width:100%; height:100%;
      object-fit:cover;
      object-position: 50% 50%;
      display:block;
      transform: scale(1.02);
      filter: saturate(1.02) contrast(1.02);
    }

    .stats{ display:grid; gap:10px; align-content:start; }
    .line{
      padding:12px;
      border-radius: 18px;
      border:1px solid rgba(12,27,42,.10);
      background: rgba(255,255,255,.56);
      color: rgba(12,27,42,.86);
      font-size:14px;
      line-height:1.45;
      position:relative;
      overflow:hidden;
      transform: translateY(0);
    }
    .line b{ color: rgba(12,27,42,.92); }
    .line.reveal{
      animation: revealUp .45s var(--ease) both;
    }
    @keyframes revealUp{
      from{ opacity:0; transform: translateY(8px); }
      to{ opacity:1; transform: translateY(0); }
    }

    /* Lock overlay */
    .locked::after{
      content:"üîí locked";
      position:absolute;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:900;
      letter-spacing:.10em;
      text-transform:uppercase;
      font-size:12px;
      color: rgba(12,27,42,.62);
      background:
        radial-gradient(280px 140px at 30% 25%, rgba(25,211,255,.16), transparent 60%),
        radial-gradient(280px 140px at 80% 25%, rgba(124,92,255,.10), transparent 60%),
        rgba(255,255,255,.68);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border-radius: 18px;
      opacity:1;
      transition: opacity .35s var(--ease), transform .35s var(--ease);
    }
    .locked{ filter: saturate(.95); }
    .unlocked.locked::after{
      opacity:0;
      transform: scale(1.02);
      pointer-events:none;
    }

    /* Footer */
    .footer{
      max-width:1120px; margin:0 auto;
      padding: 0 18px 28px;
      color: rgba(12,27,42,.56);
      font-size:12px;
      display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap;
    }
    .footer .p{
      letter-spacing:.14em;
      text-transform:uppercase;
      font-weight:900;
      color: rgba(12,27,42,.62);
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header class="topbar">
      <div class="inner">
        <div class="brand">
          <span class="dot"></span>
          <span>protocol</span>
          <span style="opacity:.65">/</span>
          <span style="opacity:.85">ADM MODE</span>
        </div>

        <button class="btn primary" id="scanTopBtn">
          —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å multipass <span style="opacity:.65">‚Ü≥</span>
        </button>
      </div>
    </header>

    <main class="hero">
      <section class="card heroMain">
        <div class="kicker">
          <span class="chip">–±—ã—Å—Ç—Ä–æ</span>
          <span class="chip">–ø–æ–Ω—è—Ç–Ω–æ</span>
          <span class="chip">–ø–æ –¥–µ–ª—É</span>
        </div>

        <h1 class="title">
          <span class="adm">ADM MODE</span>
          <span style="display:block; margin-top:6px;">—Å–∫–∞–Ω –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</span>
        </h1>

        <p class="sub">
          –í–≤–µ–¥–∏ –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è (–≤—Ä–µ–º—è ‚Äî –µ—Å–ª–∏ –∑–Ω–∞–µ—à—å). –ü–æ–ª—É—á–∏—à—å –±–∞–∑–æ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∏ MULTIPASS.
          –ü–æ–ª–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –æ—Ç–∫—Ä–æ–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫—É.
        </p>

        <div class="manifest" aria-live="polite">
          <div class="label">
            <span>—Ñ—Ä–∞–∑–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞</span>
            <span class="sig">protocol // signed</span>
          </div>
          <div id="manifestText">–º–µ–Ω—å—à–µ —à—É–º–∞. –±–æ–ª—å—à–µ —Ç–æ—á–Ω–æ—Å—Ç–∏.</div>
        </div>

        <div style="margin-top:14px; display:flex; gap:10px; flex-wrap:wrap;">
          <button class="btn primary" id="scanMainBtn">—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å multipass</button>
          <button class="btn" id="shuffleManifest">–æ–±–Ω–æ–≤–∏—Ç—å —Ñ—Ä–∞–∑—É</button>
        </div>

        <div class="miniHint">–í—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è ‚Äî –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –æ—Å—Ç–∞–≤—å –ø—É—Å—Ç—ã–º.</div>
      </section>

      <aside class="card scanner">
        <div class="scannerTop">
          <h3>—Å–∫–∞–Ω–µ—Ä</h3>
          <div class="status">
            <span class="led" id="led"></span>
            <span id="statusText">–∂–¥—É –¥–∞—Ç—É</span>
          </div>
        </div>

        <div class="fieldRow">
          <div class="field">
            <label for="dob">–¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</label>
            <input id="dob" type="date" />
          </div>
          <div class="field">
            <label for="tob">–≤—Ä–µ–º—è (–µ—Å–ª–∏ –∑–Ω–∞–µ—à—å)</label>
            <input id="tob" type="time" />
          </div>
        </div>

        <div class="scanPane" id="scanPane" aria-hidden="true">
          <div class="scanPulse"></div>
          <div class="scanGrid"></div>
          <div class="scanLine"></div>
        </div>

        <button class="btn primary" id="scanBtn">start scan</button>
        <div class="miniHint">
          –£ –∫–∞–∂–¥–æ–≥–æ –∏–≥—Ä–æ–∫–∞ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è —Å–≤–æ–π –ø–æ—Ä—Ç—Ä–µ—Ç (–∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ 144) –∏ —Ä–µ–¥–∫–æ—Å—Ç—å.
        </div>
      </aside>
    </main>

    <section class="terminal">
      <div class="panel">
        <div class="panelHead">
          <div class="panelTitle">terminal</div>
          <div class="lights" aria-hidden="true"><span></span><span></span><span></span></div>
        </div>
        <div class="panelBody">
<pre class="log" id="termLog"><span class="muted">[system]</span> ready
<span class="muted">[hint]</span> scan starts after date input
<span class="muted">[protocol]</span> signature embedded</pre>

          <div class="paybox">
            <h4>–ø–æ–ª–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –∏–≥—Ä–æ–∫–∞</h4>
            <p>–í –±–∞–∑–æ–≤–æ–º —Å–∫–∞–Ω–µ —Ç—ã –≤–∏–¥–∏—à—å ¬´—á—Ç–æ –µ—Å—Ç—å¬ª. –í –ø–æ–ª–Ω–æ–º –¥–æ—Å—Ç—É–ø–µ ‚Äî ¬´–∫–∞–∫ —ç—Ç–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è¬ª.</p>
            <button class="btn primary" id="unlockBtn">–æ—Ç–∫—Ä—ã—Ç—å –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø</button>
          </div>
        </div>
      </div>
    </section>

    <footer class="footer">
      <div class="p">PROTOCOL</div>
      <div>¬© <span id="year"></span> ADM MODE ‚Äî signature inside.</div>
    </footer>
  </div>

  <!-- MODAL -->
  <div class="modalBack" id="modalBack" role="dialog" aria-modal="true" aria-label="MULTIPASS">
    <div class="modal">
      <div class="modalHead">
        <div class="modalTitle">
          <span class="dot" style="animation:none; box-shadow:0 0 0 8px rgba(25,211,255,.10);"></span>
          <span>multipass / generated</span>
        </div>
        <button class="close" id="closeModal">–∑–∞–∫—Ä—ã—Ç—å</button>
      </div>

      <div class="modalBody">
        <div class="stack">
          <!-- MINI (–∫–∞–∫ –ø—Ä–∞–≤–∞) -->
          <div class="pass" id="miniCard">
            <div class="mini">
              <div class="miniHead">
                <div class="t">
                  <div class="t1">MULTIPASS</div>
                  <div class="t2">
                    <b>ADM MODE</b>
                    <span class="rarityBadge" id="rarityBadgeMini">
                      <span class="rarityDot"></span>
                      <span id="rarityTextMini">COMMON</span>
                    </span>
                    <span class="rarityBadge" style="gap:6px;">
                      <span style="opacity:.75">‚Ññ</span>
                      <span id="p_no">‚Äî</span><span style="opacity:.65">/144</span>
                    </span>
                  </div>
                </div>
                <div class="seal" id="sealMini" aria-hidden="true"></div>
              </div>

              <div class="avatarFace" title="–ø–æ—Ä—Ç—Ä–µ—Ç">
                <img id="faceImg" src="" alt="–ø–æ—Ä—Ç—Ä–µ—Ç –∏–≥—Ä–æ–∫–∞">
              </div>

              <div class="miniInfo">
                <div class="kv">
                  <div class="k">id</div>
                  <div class="v" id="p_id">‚Äî</div>
                </div>
                <div class="kv">
                  <div class="k">–¥–æ—Å—Ç—É–ø</div>
                  <div class="v" id="p_access">BASIC</div>
                </div>
                <div class="kv">
                  <div class="k">—Ä–æ–ª—å</div>
                  <div class="v" id="p_role">‚Äî</div>
                </div>
                <div class="kv">
                  <div class="k">—ç–Ω–µ—Ä–≥–∏—è</div>
                  <div class="v" id="p_energy">‚Äî</div>
                </div>
              </div>

              <div class="miniFoot">
                <div class="protoSig" id="p_sig">protocol // signed</div>
                <div id="p_time">‚Äî</div>
              </div>
            </div>
          </div>

          <!-- FULL (–≤ —Ä–æ—Å—Ç + –ø–æ–¥—Ä–æ–±–Ω—ã–µ —Ö–∞—Ä-–∫–∏) -->
          <div class="pass" id="fullCard">
            <div class="full">
              <div class="fullTop">
                <div class="ttl">
                  <div class="t1">
                    FULL PLAYER CARD
                    <span class="rarityBadge" id="rarityBadgeFull">
                      <span class="rarityDot"></span>
                      <span id="rarityTextFull">COMMON</span>
                    </span>
                    <span class="rarityBadge" style="gap:6px;">
                      <span style="opacity:.75">‚Ññ</span>
                      <span id="p_no2">‚Äî</span><span style="opacity:.65">/144</span>
                    </span>
                  </div>
                  <div class="t2">—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</div>
                </div>
                <div class="seal" id="sealFull" aria-hidden="true" style="transform:rotate(6deg) scale(.92);"></div>
              </div>

              <div class="fullBody">
                <div class="avatarFull" title="–ø–æ—Ä—Ç—Ä–µ—Ç">
                  <img id="fullImg" src="" alt="–ø–æ—Ä—Ç—Ä–µ—Ç –∏–≥—Ä–æ–∫–∞">
                </div>

                <div class="stats" id="statsBox">
                  <div class="line reveal"><b>–†–æ–ª—å:</b> <span id="d_role">‚Äî</span></div>
                  <div class="line reveal"><b>–≠–Ω–µ—Ä–≥–∏—è:</b> <span id="d_energy">‚Äî</span></div>

                  <!-- Locked until unlock -->
                  <div class="line locked reveal" data-lock="1"><b>–ö–∞–∫ –¥–µ–π—Å—Ç–≤—É–µ—à—å:</b> <span id="d_action">‚Äî</span></div>
                  <div class="line locked reveal" data-lock="1"><b>–û–±—â–µ–Ω–∏–µ:</b> <span id="d_social">‚Äî</span></div>
                  <div class="line locked reveal" data-lock="1"><b>–°–∏–ª—å–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞:</b> <span id="d_strong">‚Äî</span></div>
                  <div class="line locked reveal" data-lock="1"><b>–°–ª–∞–±–æ–µ –º–µ—Å—Ç–æ:</b> <span id="d_weak">‚Äî</span></div>
                  <div class="line locked reveal" data-lock="1"><b>–¢—Ä–∏–≥–≥–µ—Ä:</b> <span id="d_trigger">‚Äî</span></div>
                  <div class="line locked reveal" data-lock="1"><b>–ù–∞–≤—ã–∫:</b> <span id="d_skill">‚Äî</span></div>
                  <div class="line locked reveal" data-lock="1"><b>–ë–æ–Ω—É—Å:</b> <span id="d_bonus">‚Äî</span></div>
                  <div class="line locked reveal" data-lock="1"><b>–ó–∞–¥–∞—á–∞ —Å–µ–π—á–∞—Å:</b> <span id="d_quest">‚Äî</span></div>
                </div>
              </div>

              <div style="display:flex; gap:10px; flex-wrap:wrap;">
                <button class="btn primary" id="exportPngBtn">—ç–∫—Å–ø–æ—Ä—Ç PNG</button>
                <button class="btn primary" id="exportPdfBtn">—ç–∫—Å–ø–æ—Ä—Ç PDF</button>
                <button class="btn" id="regenBtn">–ø–µ—Ä–µ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å</button>
              </div>

              <div class="miniHint">
                BASIC –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–∞–∑—É. FULL ACCESS –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫—É (–ø–æ–∑–∂–µ —Å—é–¥–∞ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É).
              </div>
            </div>
          </div>
        </div>

        <!-- Right: output + unlock -->
        <div class="panel">
          <div class="panelHead">
            <div class="panelTitle">terminal / output</div>
            <div class="lights" aria-hidden="true"><span></span><span></span><span></span></div>
          </div>
          <div class="panelBody">
<pre class="log" id="termOut"><span class="muted">[scan]</span> waiting...</pre>

            <div class="paybox" style="margin-top:12px;">
              <h4>üîí unlock</h4>
              <p>–ù–∞–∂–º–∏ ‚Äî –∏ –∑–∞–º–∫–∏ —Å–ø–∞–¥—É—Ç. (–û–ø–ª–∞—Ç—É –ø–æ–¥–∫–ª—é—á–∏–º –ø–æ–∑–∂–µ, –∑–¥–µ—Å—å —É–∂–µ –≥–æ—Ç–æ–≤–∞ –ª–æ–≥–∏–∫–∞ unlock.)</p>
              <button class="btn primary" id="unlockBtn2">–æ—Ç–∫—Ä—ã—Ç—å –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø</button>
              <button class="btn" id="copyBtn">–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
  // ====== UI helpers
  const $ = (id)=>document.getElementById(id);
  const modalBack = $("modalBack");
  const scanPane = $("scanPane");
  const led = $("led");
  const statusText = $("statusText");
  const termLog = $("termLog");
  const termOut = $("termOut");

  // ====== Simple phrases (no pathos)
  const phrases = [
    "–º–µ–Ω—å—à–µ —à—É–º–∞. –±–æ–ª—å—à–µ —Ç–æ—á–Ω–æ—Å—Ç–∏.",
    "—è –Ω–µ —É–≥–∞–¥—ã–≤–∞—é. —è –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é.",
    "–≤–∏–∂—É —Å—É—Ç—å ‚Äî –∏ –¥–µ–π—Å—Ç–≤—É—é.",
    "—Å–Ω–∞—á–∞–ª–∞ —è—Å–Ω–æ—Å—Ç—å. –ø–æ—Ç–æ–º —Å–∫–æ—Ä–æ—Å—Ç—å.",
    "—è —Å–æ–±–∏—Ä–∞—é —Å–≤–æ–π –±–∏–ª–¥."
  ];
  function shufflePhrase(){
    const txt = phrases[Math.floor(Math.random() * phrases.length)];
    const el = $("manifestText");
    el.style.opacity = 0;
    setTimeout(()=>{ el.textContent = txt; el.style.opacity = 1; }, 140);
  }
  $("shuffleManifest").addEventListener("click", shufflePhrase);
  shufflePhrase();

  // ====== Deterministic seed (FNV-like)
  function hashLike(str){
    let h = 2166136261;
    for(let i=0;i<str.length;i++){
      h ^= str.charCodeAt(i);
      h = Math.imul(h, 16777619);
    }
    return (h>>>0);
  }
  function pad2(n){ return String(n).padStart(2,"0"); }
  function nowStamp(){
    const d = new Date();
    return `${d.getFullYear()}-${pad2(d.getMonth()+1)}-${pad2(d.getDate())} ${pad2(d.getHours())}:${pad2(d.getMinutes())}`;
  }

  // ====== Portraits (144)
  const PORTRAITS_COUNT = 144;
  function pickPortraitIndex(seed){
    return (seed % PORTRAITS_COUNT) + 1; // 1..144
  }
  function portraitUrl(idx){
    return `assets/portraits/p${String(idx).padStart(3,"0")}.jpg`;
  }

  // ====== Rarity logic (portrait <-> build)
  // 1-6 Mythic, 7-24 Epic, 25-60 Rare, 61-144 Common
  function rarityByIndex(idx){
    if(idx <= 6) return "MYTHIC";
    if(idx <= 24) return "EPIC";
    if(idx <= 60) return "RARE";
    return "COMMON";
  }

  // Role pools by rarity (simple, understandable)
  const ROLE_COMMON = ["–Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å","—Å–±–æ—Ä—â–∏–∫","–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å","–æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä","–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å","–ø—Ä–∞–∫—Ç–∏–∫"];
  const ROLE_RARE   = ["—Å—Ç—Ä–∞—Ç–µ–≥","–ø—Ä–æ–≤–æ–¥–Ω–∏–∫","—É—Å–∫–æ—Ä–∏—Ç–µ–ª—å","—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ç–æ—Ä","–º–µ–¥–∏–∞—Ç–æ—Ä","–∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä"];
  const ROLE_EPIC   = ["–∫–æ–Ω—Ç—Ä–æ–ª—ë—Ä —Ö–∞–æ—Å–∞","–∏–≥—Ä–æ–∫ –Ω–∞ –≥—Ä–∞–Ω–∏","–º–∞—Å—Ç–µ—Ä —Ñ–æ–∫—É—Å–∞","—Å–æ–±–∏—Ä–∞—Ç–µ–ª—å –≤–ª–∏—è–Ω–∏—è"];
  const ROLE_MYTHIC = ["–ø–µ—Ä–µ–ª–æ–º—â–∏–∫ –ø—Ä–∞–≤–∏–ª","—è–¥—Ä–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞","–Ω–æ—Å–∏—Ç–µ–ª—å –¥–æ—Å—Ç—É–ø–∞"];

  // Other simple traits
  const ENERGY = ["—Ä–æ–≤–Ω–∞—è","—Ä—ã–≤–∫–∞–º–∏","–≤—ã—Å–æ–∫–∞—è","–±–µ—Ä–µ–∂–Ω–∞—è","—Ç–≤–æ—Ä—á–µ—Å–∫–∞—è","–±–æ–µ–≤–æ–π —Ä–µ–∂–∏–º"];
  const ACTION = ["—Å–Ω–∞—á–∞–ª–∞ –¥—É–º–∞—é, –ø–æ—Ç–æ–º –¥–µ–ª–∞—é","–¥–µ–ª–∞—é –±—ã—Å—Ç—Ä–æ, –ø–æ—Ç–æ–º –ø—Ä–∞–≤–ª—é","–¥–µ–ª–∞—é —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —è—Å–Ω–æ","–¥–µ–ª–∞—é —á–µ—Ä–µ–∑ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ"];
  const SOCIAL = ["—É–∑–∫–∏–π –∫—Ä—É–≥","–ª–µ–≥–∫–æ –∑–Ω–∞–∫–æ–º–ª—é—Å—å","–º–Ω–µ –Ω—É–∂–Ω–∞ –¥–∏—Å—Ç–∞–Ω—Ü–∏—è","—è –≤–µ–¥—É —Ä–∞–∑–≥–æ–≤–æ—Ä","—è –º—è–≥–∫–æ –≤–µ–¥—É"];
  const STRONG = ["—è—Å–Ω–æ—Å—Ç—å","—Å–∫–æ—Ä–æ—Å—Ç—å","–∏–Ω—Ç—É–∏—Ü–∏—è","–≤—ã–¥–µ—Ä–∂–∫–∞","–≤–ª–∏—è–Ω–∏–µ","—á–µ—Å—Ç–Ω–æ—Å—Ç—å"];
  const WEAK   = ["–ø–µ—Ä–µ–≥—Ä—É–∑","—Å–∞–º–æ–∫—Ä–∏—Ç–∏–∫–∞","–æ—Ç–∫–ª–∞–¥—ã–≤–∞–Ω–∏–µ","—Ä–µ–∑–∫–æ—Å—Ç—å","—É—Å—Ç–∞–ª–æ—Å—Ç—å","—ç–º–æ-–∫–∞—á–µ–ª–∏"];
  const TRIG   = ["–¥–∞–≤–ª–µ–Ω–∏–µ","–∫–æ–Ω—Ç—Ä–æ–ª—å","–Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç—å","–Ω–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å","—Ö–∞–æ—Å","–æ–±–µ—Å—Ü–µ–Ω–∏–≤–∞–Ω–∏–µ"];
  const SKILL  = ["–¥–µ—Ä–∂–∞—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã","–≤–∏–¥–µ—Ç—å —Å—É—Ç—å","—Ä–µ–∑–∞—Ç—å –ª–∏—à–Ω–µ–µ","—Å–æ–±–∏—Ä–∞—Ç—å –ø–ª–∞–Ω","–ø–æ–¥–Ω–∏–º–∞—Ç—å —Å–µ–±—è","–≤–µ—Å—Ç–∏ –ª—é–¥–µ–π"];
  const BONUS  = ["—á—É–≤—Å—Ç–≤–æ –ø—Ä–∞–≤–¥—ã","+—Ñ–æ–∫—É—Å","+—Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è","+—Å—Ç–æ–π–∫–æ—Å—Ç—å","+–∏–Ω—Ç—É–∏—Ü–∏—è"];
  const QUEST  = ["–Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–∂–∏–º","–ø–æ—á–∏—Å—Ç–∏—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ","—Å–æ–±—Ä–∞—Ç—å —Ü–µ–ª—å","—É—Å–∏–ª–∏—Ç—å —Ç–µ–ª–æ","–≤—ã—Å—Ç—Ä–æ–∏—Ç—å –¥–µ–Ω—å–≥–∏","—Å–¥–µ–ª–∞—Ç—å —à–∞–≥ –≤ –Ω–æ–≤–æ–µ"];

  function pick(list, seed){ return list[seed % list.length]; }

  // ====== Lock / Unlock
  let unlocked = false;
  function applyUnlockState(){
    const lockedEls = document.querySelectorAll("[data-lock='1']");
    lockedEls.forEach((el, i)=>{
      if(unlocked){
        el.classList.add("unlocked");
        // –ª—ë–≥–∫–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –ø–æ—Å–ª–µ —Å–Ω—è—Ç–∏—è –∑–∞–º–∫–∞
        setTimeout(()=>{ el.classList.remove("locked"); }, 140 + i*40);
      } else {
        el.classList.add("locked");
        el.classList.remove("unlocked");
      }
    });

    $("p_access").textContent = unlocked ? "FULL" : "BASIC";
  }

  // ====== Build payload
  function buildPayload(){
    const dob = $("dob").value.trim();
    const tob = ($("tob").value.trim() || "00:00");
    const seed = hashLike(`${dob}|${tob}|ADM`);

    const idx = pickPortraitIndex(seed);
    const rarity = rarityByIndex(idx);

    let rolePool = ROLE_COMMON;
    if(rarity === "RARE") rolePool = ROLE_RARE;
    if(rarity === "EPIC") rolePool = ROLE_EPIC;
    if(rarity === "MYTHIC") rolePool = ROLE_MYTHIC;

    // make "rarity affects build" a bit:
    const role = pick(rolePool, seed >>> 1);
    const energy = pick(ENERGY, seed >>> 2);
    const action = pick(ACTION, seed >>> 3);
    const social = pick(SOCIAL, seed >>> 4);
    const strong = pick(STRONG, seed >>> 5);
    const weak   = pick(WEAK,   seed >>> 6);
    const trigger= pick(TRIG,   seed >>> 7);
    const skill  = pick(SKILL,  seed >>> 8);
    let bonus    = pick(BONUS,  seed >>> 9);
    let quest    = pick(QUEST,  seed >>> 10);

    // Rare boost flavor
    if(rarity === "EPIC") bonus = bonus + " (—É—Å–∏–ª–µ–Ω–æ)";
    if(rarity === "MYTHIC") { bonus = bonus + " (–º–∞–∫—Å–∏–º—É–º)"; quest = "—É—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç—É–ø–∞"; }

    return {
      dob, tob, seed,
      id: "ADM-" + String(seed).slice(0,10),
      portraitIndex: idx,
      portraitUrl: portraitUrl(idx),
      rarity,
      role, energy, action, social, strong, weak, trigger, skill, bonus, quest,
      sig: "protocol // signed",
      time: nowStamp()
    };
  }

  // ====== Render
  function setRarityUI(rarity){
    const mapClass = {
      "COMMON":"rarityCommon",
      "RARE":"rarityRare",
      "EPIC":"rarityEpic",
      "MYTHIC":"rarityMythic"
    };

    const badgeMini = $("rarityBadgeMini");
    const badgeFull = $("rarityBadgeFull");
    badgeMini.className = "rarityBadge " + mapClass[rarity];
    badgeFull.className = "rarityBadge " + mapClass[rarity];
    $("rarityTextMini").textContent = rarity;
    $("rarityTextFull").textContent = rarity;

    // tiny stamp reaction
    const s1 = $("sealMini"), s2 = $("sealFull");
    if(rarity === "MYTHIC"){ s1.style.transform="scale(1.02) rotate(-5deg)"; s2.style.transform="scale(.98) rotate(10deg)"; }
    else if(rarity === "EPIC"){ s1.style.transform="scale(.98) rotate(-3deg)"; s2.style.transform="scale(.96) rotate(8deg)"; }
    else { s1.style.transform=""; s2.style.transform=""; }
  }

  function render(p){
    // Portraits
    $("faceImg").src = p.portraitUrl;
    $("fullImg").src = p.portraitUrl;

    // Collection number
    $("p_no").textContent = String(p.portraitIndex).padStart(3,"0");
    $("p_no2").textContent = String(p.portraitIndex).padStart(3,"0");

    // Mini
    $("p_id").textContent = p.id;
    $("p_role").textContent = p.role;
    $("p_energy").textContent = p.energy;
    $("p_sig").textContent = p.sig;
    $("p_time").textContent = p.time;

    // Full
    $("d_role").textContent = p.role;
    $("d_energy").textContent = p.energy;
    $("d_action").textContent = p.action;
    $("d_social").textContent = p.social;
    $("d_strong").textContent = p.strong;
    $("d_weak").textContent = p.weak;
    $("d_trigger").textContent = p.trigger;
    $("d_skill").textContent = p.skill;
    $("d_bonus").textContent = p.bonus;
    $("d_quest").textContent = p.quest;

    // Rarity badges
    setRarityUI(p.rarity);

    // Terminal output
    termOut.innerHTML =
`<span class="muted">[scan]</span> <span class="ok">complete</span>
<span class="muted">[input]</span> dob=${p.dob}  tob=${(p.tob==="00:00" ? "‚Äî" : p.tob)}
<span class="muted">[id]</span> ${p.id}
<span class="muted">[portrait]</span> #${String(p.portraitIndex).padStart(3,"0")}/144 (${p.rarity})
<span class="muted">[basic]</span> —Ä–æ–ª—å=${p.role} | —ç–Ω–µ—Ä–≥–∏—è=${p.energy}
<span class="muted">[locked]</span> –ø–æ–¥—Ä–æ–±–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –∑–∞–∫—Ä—ã—Ç—ã –¥–æ –¥–æ—Å—Ç—É–ø–∞
<span class="muted">[stamp]</span> embedded
<span class="muted">[protocol]</span> ${p.sig}
<span class="muted">[time]</span> ${p.time}`;

    // Reveal animation reset
    document.querySelectorAll(".line").forEach((el, i)=>{
      el.classList.remove("reveal");
      void el.offsetWidth;
      setTimeout(()=> el.classList.add("reveal"), 20 + i*35);
    });

    applyUnlockState();
  }

  // ====== Scan flow
  function canScan(){ return $("dob").value.trim().length > 0; }
  function setReadyState(){
    if(canScan()){
      led.classList.add("live");
      statusText.textContent = "–≥–æ—Ç–æ–≤–æ";
    } else {
      led.classList.remove("live");
      statusText.textContent = "–∂–¥—É –¥–∞—Ç—É";
    }
  }
  ["dob","tob"].forEach(id => $(id).addEventListener("input", setReadyState));
  setReadyState();

  function logLine(t){
    termLog.textContent += "\n" + t;
    termLog.parentElement.scrollTop = termLog.parentElement.scrollHeight;
  }

  function openModal(){
    modalBack.classList.add("show");
    document.body.style.overflow = "hidden";
  }
  function closeModal(){
    modalBack.classList.remove("show");
    document.body.style.overflow = "";
  }
  $("closeModal").addEventListener("click", closeModal);
  modalBack.addEventListener("click", (e)=>{ if(e.target === modalBack) closeModal(); });

  let lastPayload = null;

  function startScan(){
    if(!canScan()){
      logLine("[warn] add: date of birth");
      statusText.textContent = "–Ω—É–∂–Ω–∞ –¥–∞—Ç–∞";
      return;
    }

    unlocked = false; // reset on every scan
    applyUnlockState();

    scanPane.classList.add("scanning");
    statusText.textContent = "—Å–∫–∞–Ω–∏—Ä—É—é...";
    led.classList.add("live");

    logLine("[scan] init...");
    logLine("[scan] reading input...");
    logLine("[scan] selecting portrait...");
    logLine("[scan] building multipass...");

    setTimeout(()=> logLine("[stamp] applied"), 520);
    setTimeout(()=> logLine("[protocol] signed"), 820);

    setTimeout(()=>{
      scanPane.classList.remove("scanning");
      statusText.textContent = "–≥–æ—Ç–æ–≤–æ";
      const p = buildPayload();
      lastPayload = p;
      render(p);
      openModal();
    }, 1450);
  }

  $("scanBtn").addEventListener("click", startScan);
  $("scanMainBtn").addEventListener("click", startScan);
  $("scanTopBtn").addEventListener("click", startScan);

  $("regenBtn").addEventListener("click", ()=>{
    if(!canScan()) return;
    unlocked = false;
    const p = buildPayload();
    lastPayload = p;
    render(p);
  });

  // ====== Unlock (payment hook later)
  function doUnlock(){
    unlocked = true;
    applyUnlockState();
    termOut.innerHTML += `\n<span class="muted">[unlock]</span> <span class="ok">granted</span>`;
  }
  $("unlockBtn").addEventListener("click", doUnlock);
  $("unlockBtn2").addEventListener("click", doUnlock);

  // ====== Copy
  $("copyBtn").addEventListener("click", async ()=>{
    if(!lastPayload) return;
    const p = lastPayload;
    const t =
`MULTIPASS / ADM MODE
‚Ññ: ${String(p.portraitIndex).padStart(3,"0")}/144 (${p.rarity})
ID: ${p.id}
–†–æ–ª—å: ${p.role}
–≠–Ω–µ—Ä–≥–∏—è: ${p.energy}
${unlocked ? `–ö–∞–∫ –¥–µ–π—Å—Ç–≤—É–µ—à—å: ${p.action}
–û–±—â–µ–Ω–∏–µ: ${p.social}
–°–∏–ª—å–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞: ${p.strong}
–°–ª–∞–±–æ–µ –º–µ—Å—Ç–æ: ${p.weak}
–¢—Ä–∏–≥–≥–µ—Ä: ${p.trigger}
–ù–∞–≤—ã–∫: ${p.skill}
–ë–æ–Ω—É—Å: ${p.bonus}
–ó–∞–¥–∞—á–∞: ${p.quest}` : `FULL ACCESS: locked`}
–ü–æ–¥–ø–∏—Å—å: ${p.sig}
–í—Ä–µ–º—è: ${p.time}`;
    try{
      await navigator.clipboard.writeText(t);
      termOut.innerHTML += `\n<span class="muted">[clipboard]</span> <span class="ok">copied</span>`;
    }catch(e){
      termOut.innerHTML += `\n<span class="muted">[clipboard]</span> <span class="warn">blocked</span>`;
    }
  });

  // ====== Export PNG/PDF (mini + full)
  async function nodeToPngDataUrl(node){
    const canvas = await html2canvas(node, {backgroundColor: null, scale: 2});
    return canvas.toDataURL("image/png");
  }
  function downloadDataUrl(dataUrl, filename){
    const a = document.createElement("a");
    a.href = dataUrl;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    a.remove();
  }

  $("exportPngBtn").addEventListener("click", async ()=>{
    if(!lastPayload) return;
    const n = String(lastPayload.portraitIndex).padStart(3,"0");
    const mini = $("miniCard");
    const full = $("fullCard");
    const d1 = await nodeToPngDataUrl(mini);
    const d2 = await nodeToPngDataUrl(full);
    downloadDataUrl(d1, `ADM_MULTIPASS_${n}_mini.png`);
    downloadDataUrl(d2, `ADM_MULTIPASS_${n}_full.png`);
    termOut.innerHTML += `\n<span class="muted">[export]</span> <span class="ok">png saved</span>`;
  });

  $("exportPdfBtn").addEventListener("click", async ()=>{
    if(!lastPayload) return;
    const { jsPDF } = window.jspdf;
    const n = String(lastPayload.portraitIndex).padStart(3,"0");
    const mini = $("miniCard");
    const full = $("fullCard");
    const d1 = await nodeToPngDataUrl(mini);
    const d2 = await nodeToPngDataUrl(full);

    // A4 portrait
    const pdf = new jsPDF({ orientation:"p", unit:"pt", format:"a4" });
    const pageW = pdf.internal.pageSize.getWidth();
    const margin = 28;
    const maxW = pageW - margin*2;

    // place mini then full
    const img1 = new Image(); img1.src = d1;
    const img2 = new Image(); img2.src = d2;

    await new Promise(r=> img1.onload = r);
    await new Promise(r=> img2.onload = r);

    const h1 = (img1.height / img1.width) * maxW;
    const h2 = (img2.height / img2.width) * maxW;

    let y = margin;
    pdf.addImage(d1, "PNG", margin, y, maxW, h1);
    y += h1 + 18;
    pdf.addImage(d2, "PNG", margin, y, maxW, h2);

    pdf.save(`ADM_MULTIPASS_${n}.pdf`);
    termOut.innerHTML += `\n<span class="muted">[export]</span> <span class="ok">pdf saved</span>`;
  });

  // ====== Year
  $("year").textContent = new Date().getFullYear();
</script>
</body>
</html>
