<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>PRTCL 108 — ADM MODE</title>
<meta name="description" content="PRTCL 108 — терминал сканирования персонажа. MULTIPASS, выбор, сценарии и апгрейд доступа."/>
<meta name="theme-color" content="#050b10"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>

<style>
:root{
  --bg0:#050b10; --bg1:#07131c; --bg2:#0a1a25;
  --txt:#eaf3ff; --mut:rgba(234,243,255,.72); --dim:rgba(234,243,255,.52);
  --stroke:rgba(220,235,255,.14); --stroke2:rgba(220,235,255,.26);
  --glass:rgba(240,245,255,.06); --glass2:rgba(240,245,255,.10);
  --ice:#c8f5ff; --pearl:#d9d0ff; --danger:#ff547a; --ok:#86ffd6;
  --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
  --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial;
  --r1:18px; --r2:28px;
}

*{box-sizing:border-box}
html,body{height:100%; overscroll-behavior:none}
body{
  margin:0; color:var(--txt); font-family:var(--sans);
  background:
    radial-gradient(1200px 800px at 70% 10%, rgba(185,165,255,.22), transparent 55%),
    radial-gradient(900px 600px at 20% 30%, rgba(200,245,255,.16), transparent 60%),
    radial-gradient(700px 500px at 70% 75%, rgba(255,84,122,.10), transparent 55%),
    linear-gradient(180deg, var(--bg0), var(--bg1) 40%, var(--bg2));
  overflow-x:hidden;
  -webkit-font-smoothing:antialiased;
  -webkit-tap-highlight-color:transparent;
  -webkit-user-select:none; user-select:none;
}
input,select,textarea{-webkit-user-select:text; user-select:text}

.noise:before{
  content:""; position:fixed; inset:0; pointer-events:none; z-index:0; opacity:.08; mix-blend-mode:overlay;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='220' height='220' filter='url(%23n)' opacity='.18'/%3E%3C/svg%3E");
}

.wrap{max-width:1100px;margin:0 auto;padding:18px 14px 92px; position:relative; z-index:1;}
.topbar{
  display:flex; align-items:center; justify-content:space-between; gap:10px;
  border:1px solid var(--stroke);
  background:linear-gradient(180deg, rgba(240,245,255,.08), rgba(240,245,255,.04));
  border-radius:999px;
  padding:10px 12px;
  box-shadow: 0 18px 70px rgba(0,0,0,.45);
  backdrop-filter: blur(14px);
}
.brand{display:flex; align-items:center; gap:10px; font-family:var(--mono); letter-spacing:.18em; text-transform:uppercase; font-weight:900;}
.dot{
  width:10px;height:10px;border-radius:50%;
  background:radial-gradient(circle at 30% 30%, #fff, var(--ice));
  box-shadow:0 0 14px rgba(200,245,255,.32);
  animation:pulse 2.4s ease-in-out infinite;
}
@keyframes pulse{0%,100%{transform:scale(1);opacity:.75}50%{transform:scale(1.6);opacity:1}}
.access{
  font-family:var(--mono); letter-spacing:.14em; text-transform:uppercase;
  font-size:12px; color:rgba(234,243,255,.72);
  border:1px solid rgba(220,235,255,.18);
  background:rgba(5,11,16,.28);
  padding:8px 10px; border-radius:999px;
}
.mini{display:flex; gap:10px; align-items:center}
.link{
  font-family:var(--mono); letter-spacing:.12em; text-transform:uppercase;
  font-size:11px; color:rgba(234,243,255,.62);
  padding:8px 10px; border-radius:999px;
  border:1px solid rgba(220,235,255,.14);
  background:rgba(5,11,16,.20);
  cursor:pointer;
}
.link:hover{border-color:rgba(220,235,255,.26)}

.hero{
  margin-top:14px;
  border:1px solid var(--stroke);
  background:linear-gradient(180deg, rgba(240,245,255,.08), rgba(240,245,255,.03));
  border-radius: var(--r2);
  padding:18px 16px;
  box-shadow:0 26px 90px rgba(0,0,0,.55);
  backdrop-filter: blur(16px);
  overflow:hidden;
  position:relative;
}
.hero:before{
  content:""; position:absolute; inset:-1px; pointer-events:none; opacity:.65;
  background:
    radial-gradient(520px 220px at 15% 0%, rgba(200,245,255,.14), transparent 55%),
    radial-gradient(560px 260px at 85% 100%, rgba(217,208,255,.12), transparent 58%),
    linear-gradient(90deg, rgba(255,255,255,.05), transparent 35%, rgba(255,255,255,.04));
}
.title{
  margin:8px 0 6px;
  font-size: clamp(34px, 7vw, 64px);
  font-weight:900; letter-spacing:.10em; text-transform:uppercase;
  background: linear-gradient(90deg,#fff,var(--ice),var(--pearl),#fff);
  -webkit-background-clip:text; background-clip:text; color:transparent;
  background-size:220% 100%;
  animation:shimmer 7s linear infinite;
  filter: drop-shadow(0 0 28px rgba(200,245,255,.08));
  position:relative; z-index:1;
}
@keyframes shimmer{0%{background-position:0% 50%}100%{background-position:220% 50%}}
.sub{
  font-family:var(--mono); letter-spacing:.14em; text-transform:uppercase;
  color:rgba(234,243,255,.62); font-size:12px;
  position:relative; z-index:1;
}
.pitch{
  margin-top:10px; position:relative; z-index:1;
  display:grid; grid-template-columns:1.15fr .85fr; gap:12px;
}
@media(max-width:940px){.pitch{grid-template-columns:1fr}}
.blurb{
  border:1px solid rgba(220,235,255,.12);
  background: rgba(5,11,16,.22);
  border-radius: 18px;
  padding:14px;
}
.blurb p{margin:0; font-size:15px; line-height:1.45; color:rgba(234,243,255,.86)}
.blurb p b{color:#fff}
.ticks{display:flex; flex-direction:column; gap:10px}
.tick{
  border:1px solid rgba(220,235,255,.10);
  background: rgba(5,11,16,.18);
  border-radius: 18px;
  padding:12px;
  color:rgba(234,243,255,.82);
}
.tick .k{font-family:var(--mono); letter-spacing:.12em; text-transform:uppercase; font-size:11px; color:rgba(234,243,255,.62); margin-bottom:6px}
.tick .v{font-size:14px; line-height:1.35}

.manifest{
  margin-top:12px;
  border:1px solid rgba(220,235,255,.12);
  background: rgba(5,11,16,.22);
  border-radius: 18px;
  padding:14px;
}
.manifestText{
  margin:0;
  font-size:18px;
  line-height:1.32;
  font-weight:900;
  letter-spacing:.01em;
}
.manifestText small{
  display:block;margin-top:10px;font-family:var(--mono);
  color:var(--dim);font-weight:600;letter-spacing:.10em;text-transform:uppercase;font-size:11px;
}

.grid{display:grid;grid-template-columns:1.05fr .95fr;gap:12px;margin-top:14px;}
@media(max-width:980px){.grid{grid-template-columns:1fr}}

.card{
  border:1px solid var(--stroke);
  background:linear-gradient(180deg, rgba(240,245,255,.07), rgba(240,245,255,.03));
  border-radius: var(--r2);
  overflow:hidden;
  box-shadow:0 22px 80px rgba(0,0,0,.50);
  backdrop-filter: blur(14px);
}

.cap{
  padding:14px 14px;
  border-bottom:1px solid rgba(220,235,255,.10);
  display:flex; align-items:center; justify-content:space-between; gap:10px;
  background: linear-gradient(90deg, rgba(200,245,255,.08), rgba(217,208,255,.06), transparent);
}
.cap h3{
  margin:0; font-family:var(--mono); letter-spacing:.14em; text-transform:uppercase;
  font-size:12px; color:rgba(234,243,255,.72);
}
.chip{
  font-family:var(--mono); letter-spacing:.12em; text-transform:uppercase;
  font-size:11px; color:rgba(234,243,255,.65);
  border:1px solid rgba(220,235,255,.18);
  background:rgba(5,11,16,.24);
  padding:8px 10px;border-radius:999px;
}
.body{padding:14px}
.row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
@media(max-width:620px){.row{grid-template-columns:1fr}}

label{
  display:flex; flex-direction:column; gap:8px;
  font-family:var(--mono); letter-spacing:.14em; text-transform:uppercase;
  font-size:11px; color:rgba(234,243,255,.55);
}
input,select{
  width:100%;
  border:1px solid rgba(220,235,255,.18);
  background:rgba(5,11,16,.30);
  color:var(--txt);
  border-radius:16px;
  padding:12px 12px;
  font-size:15px;
  outline:none;
}
input:focus,select:focus{border-color:rgba(200,245,255,.42); box-shadow:0 0 0 4px rgba(200,245,255,.10)}
.actions{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-top:12px}
.btn{
  border:1px solid rgba(220,235,255,.22);
  background:linear-gradient(180deg, rgba(240,245,255,.12), rgba(240,245,255,.06));
  color:var(--txt);
  border-radius:18px;
  padding:12px 14px;
  font-family:var(--mono);
  letter-spacing:.12em; text-transform:uppercase; font-weight:900;
  cursor:pointer;
  box-shadow:0 16px 60px rgba(0,0,0,.35);
  transition:transform .15s ease, border .15s ease, filter .15s ease;
}
.btn:active{transform:scale(.99)}
.btn.primary{
  border-color: rgba(200,245,255,.34);
  background: linear-gradient(90deg, rgba(200,245,255,.14), rgba(217,208,255,.12));
  position:relative; overflow:hidden;
}
.btn.primary:before{
  content:""; position:absolute; inset:-40% -20%; pointer-events:none;
  background:
    radial-gradient(circle at 30% 30%, rgba(255,255,255,.22), transparent 40%),
    radial-gradient(circle at 70% 60%, rgba(200,245,255,.18), transparent 50%);
  transform:rotate(8deg); opacity:.9;
  animation:sweep 2.8s ease-in-out infinite;
}
@keyframes sweep{0%,100%{transform:translateX(-12%) rotate(8deg);opacity:.55}50%{transform:translateX(12%) rotate(8deg);opacity:.95}}
.btn.ghost{filter:saturate(.85)}
.btn.ghost:hover{border-color:rgba(220,235,255,.34)}
.btn.primary:hover{filter:saturate(1.1)}

.scanBar{height:10px;background:rgba(240,245,255,.06);border:1px solid rgba(220,235,255,.10);border-radius:999px;overflow:hidden;margin-top:12px}
.scanFill{height:100%;width:0%;background:linear-gradient(90deg, rgba(200,245,255,.25), rgba(217,208,255,.22), rgba(255,84,122,.16));transition:width 950ms ease}

.hint{font-family:var(--mono);color:var(--dim);font-size:12px;letter-spacing:.08em;line-height:1.35}
.warn{display:none;margin-top:12px;padding:12px;border-radius:18px;border:1px solid rgba(255,84,122,.35);background:rgba(255,84,122,.08);color:rgba(255,210,222,.92);line-height:1.35}
.warn b{display:block;font-family:var(--mono);letter-spacing:.14em;text-transform:uppercase;font-size:11px;margin-bottom:6px}
.hr{height:1px;background:rgba(220,235,255,.08);margin:12px 0}

.lockRow{display:grid;grid-template-columns:auto 1fr;gap:10px;align-items:start;padding:10px 0}
.lockTag{
  font-family:var(--mono); letter-spacing:.12em; text-transform:uppercase;
  font-size:11px; color:rgba(234,243,255,.55);
  border:1px solid rgba(220,235,255,.14);
  background: rgba(5,11,16,.20);
  padding:8px 10px; border-radius:999px;
}
.lockTxt{color:rgba(234,243,255,.70); line-height:1.35}
.footerWarn{margin-top:10px;font-family:var(--mono);letter-spacing:.10em;color:rgba(234,243,255,.55)}
.footerWarn b{color:rgba(234,243,255,.85)}

.modal{
  position:fixed; inset:0; display:none; align-items:center; justify-content:center;
  padding:18px; z-index:9999;
  background: rgba(0,0,0,.58);
  backdrop-filter: blur(6px);
}
.modal.show{display:flex}
.win{
  width:min(560px, 100%);
  border:1px solid rgba(220,235,255,.18);
  background: linear-gradient(180deg, rgba(240,245,255,.10), rgba(240,245,255,.05));
  border-radius: 26px;
  box-shadow: 0 30px 140px rgba(0,0,0,.75);
  overflow:hidden;
}
.winTop{
  display:flex; align-items:center; justify-content:space-between; gap:10px;
  padding:14px 14px;
  border-bottom:1px solid rgba(220,235,255,.10);
  background: linear-gradient(90deg, rgba(200,245,255,.08), rgba(217,208,255,.06), transparent);
}
.winTop .t{font-family:var(--mono);letter-spacing:.14em;text-transform:uppercase;font-size:12px;color:rgba(234,243,255,.72)}
.x{
  width:42px;height:42px;border-radius:16px;
  border:1px solid rgba(220,235,255,.18);
  background: rgba(5,11,16,.30);
  color:rgba(234,243,255,.85);
  font-size:18px; cursor:pointer;
}
.winBody{padding:14px}
.procTitle{font-size:22px;font-weight:900;letter-spacing:.02em;margin:6px 0 12px}
.procLine{
  font-family:var(--mono); letter-spacing:.10em; text-transform:uppercase;
  font-size:11px; color:rgba(234,243,255,.62);
  display:flex; justify-content:space-between; gap:12px;
}
.procBox{
  margin-top:12px;
  border:1px solid rgba(220,235,255,.12);
  background: rgba(5,11,16,.26);
  border-radius: 18px;
  padding:12px;
  min-height:120px;
}
.procMsg{font-size:14px; line-height:1.45; color:rgba(234,243,255,.86)}
.procMsg b{color:#fff}
.smallNote{margin-top:10px;font-family:var(--mono);letter-spacing:.08em;font-size:11px;color:rgba(234,243,255,.55)}

/* MULTIPASS */
.hidden{display:none !important}
.mp{display:none}
.mp.show{display:block; animation:reveal .35s ease-out}
@keyframes reveal{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}

.mpCard{
  border:1px solid rgba(220,235,255,.18);
  background:
    linear-gradient(180deg, rgba(240,245,255,.10), rgba(240,245,255,.05)),
    radial-gradient(1000px 380px at 10% 0%, rgba(200,245,255,.10), transparent 58%),
    radial-gradient(1000px 420px at 85% 100%, rgba(217,208,255,.09), transparent 62%);
  border-radius: 26px;
  box-shadow: 0 22px 80px rgba(0,0,0,.55);
  overflow:hidden;
}
.mpTop{display:flex;justify-content:space-between;align-items:flex-start;gap:10px;padding:14px;border-bottom:1px solid rgba(220,235,255,.10)}
.mpBrand{display:flex;flex-direction:column;gap:4px}
.mpBrand .a{font-family:var(--mono);letter-spacing:.18em;text-transform:uppercase;font-size:13px;font-weight:900;color:rgba(234,243,255,.90)}
.mpBrand .b{font-family:var(--mono);letter-spacing:.12em;text-transform:uppercase;font-size:11px;color:rgba(234,243,255,.62)}
.mpStamp{
  border:1px solid rgba(220,235,255,.22);
  border-radius:16px; padding:10px;
  background: rgba(5,11,16,.30);
  text-align:right; min-width:170px;
}
.mpStamp .l{font-family:var(--mono);letter-spacing:.14em;text-transform:uppercase;font-size:10px;color:rgba(234,243,255,.60)}
.mpStamp .v{margin-top:6px;font-family:var(--mono);letter-spacing:.12em;text-transform:uppercase;font-size:12px;font-weight:900;color:rgba(200,245,255,.92)}
.mpGrid{display:grid;grid-template-columns:170px 1fr;gap:12px;padding:14px}
@media(max-width:420px){.mpGrid{grid-template-columns:150px 1fr}}
.eye{
  height:210px; min-height:210px;
  border-radius:18px;overflow:hidden;
  border:1px solid rgba(220,235,255,.14); background: rgba(5,11,16,.26);
  position:relative;
}
.eye .seal{
  position:absolute; left:10px; bottom:10px;
  font-family:var(--mono); letter-spacing:.14em; text-transform:uppercase; font-size:10px;
  color:rgba(234,243,255,.74);
  padding:7px 9px; border-radius:999px;
  border:1px solid rgba(220,235,255,.20);
  background: rgba(5,11,16,.45);
}
/* FIX: SVG всегда виден */
#eyeSvg, .eyeSvg{width:100%;height:100%}
#eyeSvg svg, .eyeSvg svg{display:block;width:100%;height:100%}

.fields{
  border:1px solid rgba(220,235,255,.14);
  border-radius:18px; overflow:hidden;
  background: rgba(5,11,16,.18);
}
.frow{display:flex;justify-content:space-between;gap:10px;padding:10px 12px;border-bottom:1px dashed rgba(220,235,255,.12)}
.frow:last-child{border-bottom:none}
.k{font-family:var(--mono);letter-spacing:.12em;text-transform:uppercase;font-size:11px;color:rgba(234,243,255,.62);white-space:nowrap}
.v{font-size:13.5px;font-weight:900;color:rgba(234,243,255,.92);text-align:right;max-width:58%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}

.blocks{display:grid;grid-template-columns:1fr 1fr;gap:12px;padding:0 14px 14px}
@media(max-width:820px){.blocks{grid-template-columns:1fr}}
.bl{
  border:1px solid rgba(220,235,255,.14);
  border-radius:18px; background: rgba(240,245,255,.05);
  padding:12px;
}
.bl.d{border-color: rgba(255,84,122,.22); background: rgba(255,84,122,.06)}
.bl .h{
  font-family:var(--mono);letter-spacing:.14em;text-transform:uppercase;font-size:11px;
  color:rgba(234,243,255,.72);margin-bottom:10px;display:flex;justify-content:space-between;gap:10px
}
.bl.d .h{color:rgba(255,210,222,.90)}
.bl .h span{opacity:.7;font-weight:700;letter-spacing:.10em;text-transform:none}
ul{margin:0;padding-left:16px;font-size:14px;line-height:1.45;color:rgba(234,243,255,.88)}
.stats{display:flex;flex-direction:column;gap:8px}
.stat{display:flex;align-items:center;justify-content:space-between;gap:10px;font-family:var(--mono);letter-spacing:.10em;text-transform:uppercase;font-size:11px;color:rgba(234,243,255,.70)}
.bar{flex:1;height:10px;border-radius:999px;background:rgba(5,11,16,.35);border:1px solid rgba(220,235,255,.12);overflow:hidden}
.fill{height:100%;width:50%;background:linear-gradient(90deg, rgba(200,245,255,.25), rgba(217,208,255,.22), rgba(255,84,122,.16))}
.val{width:38px;text-align:right;font-weight:900;font-family:var(--mono);color:rgba(234,243,255,.88)}
.mpFoot{
  padding:12px 14px;border-top:1px solid rgba(220,235,255,.10);
  background: rgba(5,11,16,.18);
  display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap
}
.mpHint{font-weight:900;color:rgba(234,243,255,.88)}
.code{
  font-family:var(--mono);letter-spacing:.14em;text-transform:uppercase;font-size:11px;color:rgba(234,243,255,.62);
  padding:7px 9px;border-radius:999px;border:1px solid rgba(220,235,255,.18);background: rgba(240,245,255,.05)
}

.scene{
  margin-top:12px;
  border:1px solid rgba(220,235,255,.12);
  background: rgba(5,11,16,.18);
  border-radius: 22px;
  padding:14px;
}
.sceneTop{display:flex;justify-content:space-between;gap:10px;align-items:flex-start}
.sceneId{font-family:var(--mono);letter-spacing:.14em;text-transform:uppercase;font-size:11px;color:rgba(234,243,255,.62)}
.sceneTitle{font-size:18px;font-weight:900;margin-top:6px}
.sceneTxt{margin-top:10px;color:rgba(234,243,255,.86);line-height:1.45}
.choiceGrid{display:grid;grid-template-columns:1fr;gap:10px;margin-top:12px}
.choice{
  border:1px solid rgba(220,235,255,.14);
  background: rgba(240,245,255,.05);
  border-radius: 18px;
  padding:12px;
  cursor:pointer;
  transition:transform .12s ease, border .12s ease;
}
.choice:hover{border-color:rgba(220,235,255,.28); transform:translateY(-1px)}
.choice .ct{font-family:var(--mono);letter-spacing:.12em;text-transform:uppercase;font-size:11px;color:rgba(234,243,255,.62)}
.choice .cv{margin-top:6px;font-weight:900;color:rgba(234,243,255,.92)}
.mission{
  margin-top:12px;
  border:1px solid rgba(200,245,255,.18);
  background: linear-gradient(90deg, rgba(200,245,255,.08), rgba(217,208,255,.06), rgba(5,11,16,.10));
  border-radius: 18px;
  padding:12px;
}
.mission .mt{font-family:var(--mono);letter-spacing:.14em;text-transform:uppercase;font-size:11px;color:rgba(234,243,255,.70)}
.mission .mv{margin-top:8px;color:rgba(234,243,255,.90);line-height:1.45}
.missionBtns{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}

.smallFooter{
  margin-top:16px;
  font-family:var(--mono);
  letter-spacing:.10em;
  text-transform:uppercase;
  font-size:11px;
  color:rgba(234,243,255,.50);
  text-align:center;
}
</style>
</head>
<body class="noise">
  <div class="wrap">

    <div class="topbar">
      <div class="brand"><span class="dot"></span><span>PRTCL 108</span></div>
      <div class="mini">
        <div class="access" id="accessBadge">ACCESS: LOCKED</div>
        <div class="link" id="helpBtn">как это работает</div>
      </div>
    </div>

    <div class="hero">
      <div class="title">PRTCL 108</div>
      <div class="sub">COLD PROTOCOL / MIRROR INTERFACE</div>

      <div class="pitch">
        <div class="blurb">
          <p>
            Это не “мотивация” и не “советы”.<br>
            <b>PRTCL 108</b> — терминал, который собирает твою конфигурацию и показывает,
            где ты реально теряешь управление, а где можешь его вернуть одним ходом.
          </p>
        </div>
        <div class="ticks">
          <div class="tick">
            <div class="k">без воды</div>
            <div class="v">коротко. жёстко. понятно. игровыми терминами.</div>
          </div>
          <div class="tick">
            <div class="k">без публичности</div>
            <div class="v">single-player mode: данные остаются у тебя.</div>
          </div>
          <div class="tick">
            <div class="k">сюжет</div>
            <div class="v">ты входишь в мир выбора. ветка меняется от решений.</div>
          </div>
        </div>
      </div>

      <div class="manifest">
        <p class="manifestText" id="manifestText"></p>
      </div>
    </div>

    <div class="grid">

      <!-- TERMINAL -->
      <section class="card">
        <div class="cap">
          <h3>TERMINAL</h3>
          <div class="chip" id="stateChip">ОЖИДАНИЕ ВВОДА</div>
        </div>

        <div class="body">
          <div class="row">
            <label>дата рождения
              <input id="dob" inputmode="numeric" placeholder="ДД.ММ.ГГГГ" autocomplete="bday">
            </label>

            <label>аватар
              <select id="avatar">
                <option value="f">женский</option>
                <option value="m">мужской</option>
              </select>
            </label>

            <label>имя / ник (опционально)
              <input id="name" placeholder="например maratina">
            </label>

            <label>место рождения
              <input id="place" placeholder="город, страна (например Нальчик, Россия)">
            </label>
          </div>

          <div class="actions">
            <button class="btn primary" id="scanBtn">НАЧАТЬ СКАН</button>
            <button class="btn ghost" id="resetBtn">СБРОС</button>
          </div>

          <div class="scanBar"><div class="scanFill" id="scanFill"></div></div>

          <div class="warn" id="warn">
            <b>warning</b>
            Введи дату в формате <span style="font-family:var(--mono)">ДД.ММ.ГГГГ</span>.
          </div>

          <div class="hr"></div>

          <div class="lockRow">
            <div class="lockTag">CONFIG</div>
            <div class="lockTxt">Базовые параметры + реакция системы. Входит в бесплатный скан.</div>
          </div>

          <div class="lockRow">
            <div class="lockTag">SKILLS</div>
            <div class="lockTxt">Игровые таланты и стиль поведения. Входит в бесплатный скан.</div>
          </div>

          <div class="lockRow">
            <div class="lockTag">BLOCKERS</div>
            <div class="lockTxt">Где система крадёт управление. Полный разбор — в закрытом доступе.</div>
          </div>

          <div class="lockRow">
            <div class="lockTag">UPGRADE</div>
            <div class="lockTxt">Путь прокачки: что апгрейдить первым, чтобы результат проявился в реальности.</div>
          </div>

          <div class="footerWarn">note: формат результата — <b>точный и нейтральный</b>.</div>
        </div>
      </section>

      <!-- OUTPUT -->
      <section class="card">
        <div class="cap">
          <h3>MULTIPASS</h3>
          <div class="chip" id="outChip">НЕ АКТИВНО</div>
        </div>

        <div class="body">
          <div id="placeholder" class="hint" style="margin:0;">
            Введи данные → нажми <b>НАЧАТЬ СКАН</b> → система соберёт MULTIPASS и откроет SCENE 00.
          </div>

          <div class="mp" id="mp">
            <div class="mpCard">
              <div class="mpTop">
                <div class="mpBrand">
                  <div class="a">PRTCL 108</div>
                  <div class="b">MULTIPASS • паспорт персонажа</div>
                </div>
                <div class="mpStamp">
                  <div class="l">допуск</div>
                  <div class="v" id="mpClear">ACCESS: GRANTED</div>
                </div>
              </div>

              <div class="mpGrid">
                <div class="eye">
                  <div id="eyeSvg" class="eyeSvg"></div>
                  <div class="seal">SCAN VERIFIED</div>
                </div>

                <div class="fields">
                  <div class="frow"><span class="k">ID</span><span class="v" id="mpId"></span></div>
                  <div class="frow"><span class="k">дата рождения</span><span class="v" id="mpDob"></span></div>
                  <div class="frow"><span class="k">место</span><span class="v" id="mpPlace"></span></div>
                  <div class="frow"><span class="k">ключевая роль</span><span class="v" id="mpRole"></span></div>
                  <div class="frow"><span class="k">класс</span><span class="v" id="mpClass"></span></div>
                  <div class="frow"><span class="k">сигнал</span><span class="v" id="mpFlag"></span></div>
                </div>
              </div>

              <div class="blocks">
                <div class="bl">
                  <div class="h">таланты <span>что у тебя работает само</span></div>
                  <ul id="mpSkills"></ul>
                </div>

                <div class="bl">
                  <div class="h">характеристики <span>цифры билда</span></div>
                  <div class="stats" id="mpStats"></div>
                </div>

                <div class="bl d">
                  <div class="h">дебаффы <span>что режет управление</span></div>
                  <ul id="mpDebuffs"></ul>
                </div>

                <div class="bl">
                  <div class="h">оптимальный билд <span>как играть</span></div>
                  <ul id="mpBuild"></ul>
                </div>
              </div>

              <div class="mpFoot">
                <div class="mpHint" id="mpHint"></div>
                <div class="code">ADM MODE INSIDE</div>
              </div>
            </div>

            <!-- SCENE 00 -->
            <div class="scene" id="scene">
              <div class="sceneTop">
                <div>
                  <div class="sceneId">SCENE 00 / вход</div>
                  <div class="sceneTitle">Мир выбора активирован.</div>
                </div>
                <div class="chip" id="sceneState">ОЖИДАНИЕ ВЫБОРА</div>
              </div>

              <div class="sceneTxt" id="sceneTxt">
                Ты вошёл(ла) в режим, где решения имеют вес. Здесь нет “правильно”. Есть последствия.
                Выбери, как ты проходишь первый узел.
              </div>

              <div class="choiceGrid" id="choices"></div>

              <div class="mission" id="mission" style="display:none;">
                <div class="mt">миссия 00 / 24h</div>
                <div class="mv" id="missionTxt"></div>
                <div class="missionBtns">
                  <button class="btn primary" id="doneBtn">Я ВЫПОЛНИЛ(А)</button>
                  <button class="btn ghost" id="skipBtn">ПРОПУСТИЛ(А)</button>
                </div>
              </div>
            </div>
          </div>

          <div class="smallFooter">PRTCL 108 • метод позиционируется как новый протокол • без ссылок на источники</div>
        </div>
      </section>

    </div>
  </div>

  <!-- PROCESSING PORTAL -->
  <div class="modal" id="modal">
    <div class="win">
      <div class="winTop">
        <div class="t">processing</div>
        <button class="x" id="closeModal" aria-label="close">×</button>
      </div>
      <div class="winBody">
        <div class="procTitle">инициализация модели…</div>
        <div class="procLine"><span id="procStep">синхронизация доступа</span><span id="procPct">0%</span></div>
        <div class="scanBar" style="margin-top:10px"><div class="scanFill" id="procFill"></div></div>
        <div class="procBox">
          <div class="procMsg" id="procMsg">
            <b>PRTCL 108</b> поднимает терминал.<br>
            Система не убеждает. Система фиксирует факт.<br><br>
            Подготовка профиля персонажа…
          </div>
          <div class="smallNote" id="procNote">режим: ADM MODE • протокол: PRTCL 108</div>
        </div>
      </div>
    </div>
  </div>
  <script>
/* Telegram Mini App polish */
try{
  if (window.Telegram && Telegram.WebApp){
    Telegram.WebApp.ready();
    Telegram.WebApp.expand();
    Telegram.WebApp.BackButton.hide();
  }
}catch(e){}

/* helpers */
const $ = (id)=>document.getElementById(id);
const clamp01 = (x)=>Math.max(0,Math.min(1,x));
function escapeHtml(s){return (s||"").replace(/[&<>"']/g,m=>({ "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#039;" }[m]));}

function validDOB(d){
  const m=/^(\d{2})\.(\d{2})\.(\d{4})$/.exec((d||"").trim()); if(!m) return false;
  const dd=+m[1],mm=+m[2],yy=+m[3];
  if(mm<1||mm>12||dd<1||dd>31||yy<1900||yy>2100) return false;
  const dt=new Date(yy,mm-1,dd);
  return dt && dt.getFullYear()===yy && dt.getMonth()===(mm-1) && dt.getDate()===dd;
}
function hashStr(str){
  let h=2166136261;
  for(let i=0;i<str.length;i++){ h^=str.charCodeAt(i); h=Math.imul(h,16777619); }
  return (h>>>0);
}
function rng32(seed){
  return function(){
    let t = seed += 0x6D2B79F5;
    t = Math.imul(t ^ (t >>> 15), t | 1);
    t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
    return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
  }
}
function pick(rng, arr){ return arr[Math.floor(rng()*arr.length)]; }
function shuffle(rng, arr){
  const a=arr.slice();
  for(let i=a.length-1;i>0;i--){
    const j=Math.floor(rng()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}
function makeId(dob){
  const m=/^(\d{2})\.(\d{2})\.(\d{4})$/.exec(dob);
  return `PRTCL-108-${m[1]}${m[2]}${m[3].slice(2)}`;
}

/* manifesto rotates */
const MANIFEST=[
  "Если система закрывает двери — я становлюсь дверью.<br>Если система ставит границы — я становлюсь линией разрыва.<small>PRTCL 108 / ADM MODE</small>",
  "Я не прошу разрешения.<br>Я создаю протокол.<small>PRTCL 108 / ADM MODE</small>",
  "Никакой воды. Только протокол.<br>Никаких уговоров. Только выбор.<small>PRTCL 108 / ADM MODE</small>",
  "Сценарий меняется не от мыслей.<br>Сценарий меняется от хода.<small>PRTCL 108 / ADM MODE</small>"
];
$("manifestText").innerHTML = MANIFEST[Math.floor(Math.random()*MANIFEST.length)];

/* game dictionaries */
const ROLES=[
  "Инициатор Разрыва (запускает движение, когда все стоят)",
  "Диспетчер Реальности (управляет веткой событий)",
  "Хирург Связей (режет мёртвое без сожалений)",
  "Командир Перезапуска (поднимает режим после падения)",
  "Оператор Прорыва (делает 1 ход, который решает всё)"
];
const CLASSES=[
  "Системный Катализатор (ускоряет процессы вокруг)",
  "Холодный Оператор (точность вместо эмоций)",
  "Анти-Паттерн (ломает «как принято»)",
  "Рерайтер Сценариев (переписывает правила игры)"
];
const FLAGS=[
  "ВНЕ СЕТКИ (плохо управляется системой)",
  "СМЕЩЕНИЕ КОНТУРА (меняет правила присутствием)",
  "СИЛОВОЙ СИГНАЛ (люди чувствуют давление)",
  "ДОСТУП ЧЕРЕЗ ДЕЙСТВИЕ (не через слова)"
];
const SKILLS=[
  "Скан Лжи — видишь несостыковки сразу",
  "Железная Воля — держишь курс, когда всем страшно",
  "Сдвиг Реальности — один ход меняет расклад",
  "Режим Холод — отключаешь шум, включаешь точность",
  "Разрыв Связей — уходишь без откатов",
  "Иммунитет к Массе — не заражаешься толпой",
  "Точечный Удар — минимум действий, максимум эффекта",
  "Нулевая Поза — умеешь стоять, когда другие суетятся"
];
const DEBUFFS=[
  "Петля Объяснений — тратишь энергию на слова",
  "Задержка Старта — перегрев от ожидания",
  "Ловушка Идеала — стоп из-за планки",
  "Якорь на Людях — лояльность мёртвым связям",
  "Саботаж Скукой — выключает мотивацию",
  "Слив Через Тревогу — скачки вместо курса"
];
const BUILDS=[
  "Один Рывок → Пауза (не дави бесконечно)",
  "Тишина → Удар (сначала очистка, потом действие)",
  "Срезать → Запустить (убери лишнее и начни)",
  "Контроль Среды (меняй окружение, не себя)",
  "Действие вместо анализа (30 секунд на решение)",
  "Правило 1 Хода (один конкретный шаг в день)"
];
const HINTS=[
  "Ключ: старт. Если ждёшь — ветка уходит.",
  "Тебе нельзя объяснять. Тебе можно делать.",
  "Тишина лечит. Шум ломает.",
  "Окружение — твой усилитель. Выбирай строго.",
  "Система уважает только действие."
];

/* Eye SVG: female has lashes */
function eyeSVG(variant){
  const lashes = (variant==="f")
    ? `<path d="M44 56 q18-18 36 0" stroke="rgba(255,255,255,.20)" stroke-width="3" fill="none"/>
       <path d="M48 52 l-6-6" stroke="rgba(255,255,255,.18)" stroke-width="2"/>
       <path d="M58 48 l-5-7" stroke="rgba(255,255,255,.18)" stroke-width="2"/>
       <path d="M70 47 l-3-8" stroke="rgba(255,255,255,.18)" stroke-width="2"/>
       <path d="M82 48 l1-8" stroke="rgba(255,255,255,.18)" stroke-width="2"/>
       <path d="M94 52 l6-6" stroke="rgba(255,255,255,.18)" stroke-width="2"/>`
    : ``;

  return `
  <svg viewBox="0 0 180 240" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <radialGradient id="g1" cx="30%" cy="20%" r="80%">
        <stop offset="0" stop-color="rgba(200,245,255,.20)"/>
        <stop offset="0.6" stop-color="rgba(217,208,255,.10)"/>
        <stop offset="1" stop-color="rgba(0,0,0,0)"/>
      </radialGradient>
      <linearGradient id="hud" x1="0" x2="1">
        <stop offset="0" stop-color="rgba(200,245,255,.35)"/>
        <stop offset="0.5" stop-color="rgba(217,208,255,.28)"/>
        <stop offset="1" stop-color="rgba(255,84,122,.18)"/>
      </linearGradient>
    </defs>

    <rect x="0" y="0" width="180" height="240" fill="rgba(5,11,16,.55)"/>
    <rect x="0" y="0" width="180" height="240" fill="url(#g1)"/>
    ${Array.from({length:16}).map((_,i)=>`<rect x="0" y="${i*15}" width="180" height="1" fill="rgba(255,255,255,.06)"/>`).join("")}

    <rect x="14" y="16" width="152" height="208" rx="18" fill="none" stroke="rgba(220,235,255,.14)"/>
    <path d="M24 34 h60" stroke="url(#hud)" stroke-width="2" opacity=".7"/>
    <path d="M24 206 h90" stroke="url(#hud)" stroke-width="2" opacity=".55"/>

    <g transform="translate(0,10)">
      <ellipse cx="90" cy="110" rx="58" ry="28" fill="rgba(0,0,0,.25)" stroke="rgba(220,235,255,.18)" stroke-width="2"/>
      <ellipse cx="90" cy="110" rx="46" ry="20" fill="rgba(5,11,16,.55)"/>
      <ellipse cx="90" cy="110" rx="18" ry="18" fill="rgba(200,245,255,.18)" stroke="rgba(200,245,255,.35)" stroke-width="2"/>
      <circle cx="90" cy="110" r="7" fill="rgba(0,0,0,.55)"/>
      <circle cx="96" cy="104" r="3" fill="rgba(255,255,255,.45)"/>
      <path d="M32 110 q58-52 116 0" fill="none" stroke="rgba(220,235,255,.16)" stroke-width="3"/>
      <path d="M32 110 q58 52 116 0" fill="none" stroke="rgba(220,235,255,.10)" stroke-width="3"/>
      ${lashes}
    </g>

    <text x="24" y="58" fill="rgba(234,243,255,.45)" font-family="ui-monospace, Menlo, Monaco, Consolas, monospace" font-size="10" letter-spacing="2">BIO-SCAN</text>
    <text x="24" y="74" fill="rgba(234,243,255,.35)" font-family="ui-monospace, Menlo, Monaco, Consolas, monospace" font-size="10" letter-spacing="2">PRTCL-108</text>
    <text x="24" y="90" fill="rgba(234,243,255,.30)" font-family="ui-monospace, Menlo, Monaco, Consolas, monospace" font-size="10" letter-spacing="2">EYE-ID</text>
  </svg>`;
}

/* PROCESSING steps */
const PROC_STEPS=[
  {p:12, t:"синхронизация доступа", m:"Система поднимает терминал. <b>Ты не просишь доступ — ты его подтверждаешь.</b>"},
  {p:34, t:"скан параметров", m:"Считывание базы: воля, фокус, хаос, сопротивление."},
  {p:56, t:"раскладка талантов", m:"Таланты компилируются в билд. <b>Коротко. Понятно. По делу.</b>"},
  {p:78, t:"поиск дебаффов", m:"Дебаффы — места, где управление уходит из рук."},
  {p:100,t:"сборка мультипасса", m:"Фиксация факта. <b>MULTIPASS готов.</b>"}
];

/* UI refs */
const dobEl=$("dob"), avatarEl=$("avatar"), nameEl=$("name"), placeEl=$("place");
const scanBtn=$("scanBtn"), resetBtn=$("resetBtn");
const warnEl=$("warn"), scanFill=$("scanFill");
const modal=$("modal"), closeModal=$("closeModal");
const procFill=$("procFill"), procPct=$("procPct"), procStep=$("procStep"), procMsg=$("procMsg");
const stateChip=$("stateChip"), outChip=$("outChip");
const accessBadge=$("accessBadge"), helpBtn=$("helpBtn");

const mp=$("mp"), placeholder=$("placeholder"), eyeSvgEl=$("eyeSvg");
const mpId=$("mpId"), mpDob=$("mpDob"), mpPlace=$("mpPlace"), mpRole=$("mpRole"), mpClass=$("mpClass"), mpFlag=$("mpFlag");
const mpSkills=$("mpSkills"), mpDebuffs=$("mpDebuffs"), mpBuild=$("mpBuild"), mpStats=$("mpStats"), mpHint=$("mpHint");

const sceneState=$("sceneState"), sceneTxt=$("sceneTxt"), choicesEl=$("choices");
const mission=$("mission"), missionTxt=$("missionTxt"), doneBtn=$("doneBtn"), skipBtn=$("skipBtn");

/* render helpers */
function setList(ul, items){ ul.innerHTML = items.map(x=>`<li>${escapeHtml(x)}</li>`).join(""); }
function setStats(container, stats){
  container.innerHTML = stats.map(s=>{
    const w=clamp01(s.v/100)*100;
    return `<div class="stat"><span>${escapeHtml(s.k)}</span><div class="bar"><div class="fill" style="width:${w}%"></div></div><span class="val">${s.v}</span></div>`;
  }).join("");
}
function genProfile(dob,name,place,avatar){
  const seed=hashStr(`${dob}|${name}|${place}|${avatar}|PRTCL108`);
  const rng=rng32(seed);
  const role=pick(rng,ROLES);
  const cls=pick(rng,CLASSES);
  const flag=pick(rng,FLAGS);
  const skills=shuffle(rng,SKILLS).slice(0,4);
  const debuffs=shuffle(rng,DEBUFFS).slice(0,3);
  const build=shuffle(rng,BUILDS).slice(0,3);
  const hint=pick(rng,HINTS);
  const stats=[
    {k:"Воля", v: Math.floor(60+rng()*41)},
    {k:"Фокус", v: Math.floor(45+rng()*56)},
    {k:"Хаос", v: Math.floor(40+rng()*61)},
    {k:"Сопротивление", v: Math.floor(35+rng()*66)},
  ];
  return {seed, role, cls, flag, skills, debuffs, build, stats, hint, avatar, name, place, dob};
}

/* modal control */
function showModal(){
  modal.classList.add("show");
  procFill.style.width="0%";
  procPct.textContent="0%";
  procStep.textContent="синхронизация доступа";
}
function hideModal(){ modal.classList.remove("show"); }
closeModal.addEventListener("click", hideModal);
modal.addEventListener("click", (e)=>{ if(e.target===modal) hideModal(); });

function runProcessing(onDone){
  showModal();
  let i=0;
  const tick=()=>{
    const s=PROC_STEPS[i];
    procStep.textContent=s.t;
    procMsg.innerHTML=s.m;
    procFill.style.width=s.p+"%";
    procPct.textContent=s.p+"%";
    i++;
    if(i<PROC_STEPS.length) setTimeout(tick, 520);
    else setTimeout(()=>{ hideModal(); onDone(); }, 420);
  };
  setTimeout(tick, 220);
}

/* SCENE 00 choices */
const SCENE_CHOICES=[
  {id:"STABILITY", t:"выбор 01", v:"Сохранить стабильность и не трогать узел."},
  {id:"CUT", t:"выбор 02", v:"Срезать лишнее: убрать одну уступку системе."},
  {id:"MOVE", t:"выбор 03", v:"Сделать ход: маленькое действие сегодня, без обсуждений."}
];
const MISSIONS={
  STABILITY:"В течение 24 часов: не принимай решений в спешке. Одна пауза перед ответом. Зафиксируй момент, когда тебя тянет согласиться автоматически.",
  CUT:"В течение 24 часов: убери одну уступку. Любую. Маленькую. Не объясняй никому. Вернись и отметь выполнение.",
  MOVE:"В течение 24 часов: сделай один конкретный шаг по делу (1 сообщение / 1 заявка / 1 действие). Без подготовки. Затем отметь выполнение."
};

let STATE = loadState();

function renderChoices(){
  choicesEl.innerHTML = SCENE_CHOICES.map(c=>`
    <div class="choice" data-id="${c.id}">
      <div class="ct">${c.t}</div>
      <div class="cv">${c.v}</div>
    </div>
  `).join("");
  [...choicesEl.querySelectorAll(".choice")].forEach(el=>{
    el.addEventListener("click", ()=>choose(el.getAttribute("data-id")));
  });
}
function choose(id){
  if(!STATE.profile) return;
  STATE.scene = {choice:id, mission:"PENDING", ts:Date.now()};
  saveState();
  sceneState.textContent="ВЫБОР ЗАФИКСИРОВАН";
  sceneTxt.textContent="Система приняла выбор. Следующий шаг — действие. Без действий выбор остаётся текстом.";
  mission.style.display="block";
  missionTxt.textContent = MISSIONS[id] || "Миссия не найдена.";
}
doneBtn.addEventListener("click", ()=>{
  if(!STATE.scene) return;
  STATE.scene.mission="DONE";
  saveState();
  sceneState.textContent="МИССИЯ ВЫПОЛНЕНА";
  sceneTxt.textContent="Доступ подтверждён действием. Ветка усилена. Следующие сцены будут глубже.";
});
skipBtn.addEventListener("click", ()=>{
  if(!STATE.scene) return;
  STATE.scene.mission="SKIPPED";
  saveState();
  sceneState.textContent="МИССИЯ ПРОПУЩЕНА";
  sceneTxt.textContent="Система зафиксировала откат. Это не провал — это текущая ветка. Продолжишь позже.";
});

/* storage */
function loadState(){
  try{
    const raw = localStorage.getItem("prtcl108_state");
    return raw ? JSON.parse(raw) : {profile:null, scene:null};
  }catch(e){ return {profile:null, scene:null}; }
}
function saveState(){
  try{ localStorage.setItem("prtcl108_state", JSON.stringify(STATE)); }catch(e){}
}

/* restore UI if state exists */
function renderFromState(){
  renderChoices();
  if(STATE.profile){
    placeholder.style.display="none";
    mp.classList.add("show"); mp.style.display="block";
    outChip.textContent="SCAN COMPLETE";
    stateChip.textContent="СКАН ЗАВЕРШЕН";
    accessBadge.textContent="ACCESS: GRANTED";

    const p=STATE.profile;
    mpId.textContent = makeId(p.dob);
    mpDob.textContent = p.dob;
    mpPlace.textContent = p.place || "НЕ УКАЗАНО";
    mpRole.textContent = p.role;
    mpClass.textContent = p.cls;
    mpFlag.textContent = p.flag;

    setList(mpSkills, p.skills);
    setList(mpDebuffs, p.debuffs);
    setList(mpBuild, p.build);
    setStats(mpStats, p.stats);
    mpHint.textContent = p.hint;

    // FIX: глаз рендерится всегда (контейнер + svg display:block)
    if (eyeSvgEl){
      eyeSvgEl.innerHTML = eyeSVG(p.avatar);
    }

    // scene restore
    if(STATE.scene){
      mission.style.display="block";
      missionTxt.textContent = MISSIONS[STATE.scene.choice] || "—";
      if(STATE.scene.mission==="DONE"){
        sceneState.textContent="МИССИЯ ВЫПОЛНЕНА";
        sceneTxt.textContent="Доступ подтверждён действием. Следующие сцены будут глубже.";
      }else if(STATE.scene.mission==="SKIPPED"){
        sceneState.textContent="МИССИЯ ПРОПУЩЕНА";
        sceneTxt.textContent="Система зафиксировала откат. Продолжишь позже.";
      }else{
        sceneState.textContent="ВЫБОР ЗАФИКСИРОВАН";
        sceneTxt.textContent="Система приняла выбор. Следующий шаг — действие.";
      }
    }else{
      sceneState.textContent="ОЖИДАНИЕ ВЫБОРА";
      mission.style.display="none";
    }
  }else{
    renderChoices();
  }
}

/* main scan */
function scan(){
  const dob=(dobEl.value||"").trim();
  const avatar=(avatarEl.value||"f").trim();
  const name=(nameEl.value||"").trim();
  const place=((placeEl.value||"").trim() || "НЕ УКАЗАНО");

  if(!validDOB(dob)){
    warnEl.style.display="block";
    return;
  }
  warnEl.style.display="none";

  stateChip.textContent="ИНИЦИАЛИЗАЦИЯ…";
  outChip.textContent="PROCESSING";
  scanFill.style.width="0%";
  setTimeout(()=>scanFill.style.width="100%",50);

  runProcessing(()=>{
    const profile=genProfile(dob,name,place,avatar);

    // fill multipass
    if (eyeSvgEl) eyeSvgEl.innerHTML = eyeSVG(avatar); // FIX: глаз
    mpId.textContent = makeId(dob);
    mpDob.textContent = dob;
    mpPlace.textContent = place;
    mpRole.textContent = profile.role;
    mpClass.textContent = profile.cls;
    mpFlag.textContent = profile.flag;

    setList(mpSkills, profile.skills);
    setList(mpDebuffs, profile.debuffs);
    setList(mpBuild, profile.build);
    setStats(mpStats, profile.stats);
    mpHint.textContent = profile.hint;

    placeholder.style.display="none";
    mp.classList.add("show"); mp.style.display="block";

    stateChip.textContent="СКАН ЗАВЕРШЕН";
    outChip.textContent="SCAN COMPLETE";
    accessBadge.textContent="ACCESS: GRANTED";

    // rotate manifesto
    $("manifestText").innerHTML = MANIFEST[Math.floor(Math.random()*MANIFEST.length)];

    // set state
    STATE.profile = profile;
    STATE.scene = null;
    saveState();

    // scene ready
    renderChoices();
    sceneState.textContent="ОЖИДАНИЕ ВЫБОРА";
    mission.style.display="none";
    sceneTxt.textContent="Ты вошёл(ла) в режим, где решения имеют вес. Выбери, как ты проходишь первый узел.";
  });
}

function reset(){
  dobEl.value=""; nameEl.value=""; placeEl.value=""; avatarEl.value="f";
  warnEl.style.display="none";
  scanFill.style.width="0%";
  placeholder.style.display="block";
  mp.style.display="none"; mp.classList.remove("show");
  stateChip.textContent="ОЖИДАНИЕ ВВОДА";
  outChip.textContent="НЕ АКТИВНО";
  accessBadge.textContent="ACCESS: LOCKED";
  $("manifestText").innerHTML = MANIFEST[Math.floor(Math.random()*MANIFEST.length)];

  STATE = {profile:null, scene:null};
  saveState();
  renderChoices();
  mission.style.display="none";
}

scanBtn.addEventListener("click", scan);
resetBtn.addEventListener("click", reset);

helpBtn.addEventListener("click", ()=>{
  alert("PRTCL 108 — это терминал. Ты вводишь данные → получаешь MULTIPASS → выбираешь ход → выполняешь миссию. Это не мотивация. Это протокол выбора.");
});

/* init */
renderFromState();
</script>
</body>
</html>