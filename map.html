<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>ADM MODE — MAP / Сканирование</title>
  <meta name="description" content="ADM MODE — сканирование персонажа и генерация MULTIPASS EXTENDED."/>
  <style>
    :root{
      --bg0:#050b10; --bg1:#07121b; --bg2:#0a1a25;
      --glass: rgba(240,245,255,.07);
      --stroke: rgba(220,235,255,.18);
      --stroke2: rgba(220,235,255,.28);
      --text:#eaf3ff;
      --muted: rgba(234,243,255,.72);
      --dim: rgba(234,243,255,.52);
      --ice:#c8f5ff; --pearl:#d9d0ff; --danger:#ff547a;
      --shadow: 0 22px 80px rgba(0,0,0,.55);
      --radius2: 26px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial;
    }
    *{box-sizing:border-box}
    body{
      margin:0; color:var(--text); font-family:var(--sans);
      background:
        radial-gradient(1200px 800px at 70% 10%, rgba(185,165,255,.22), transparent 55%),
        radial-gradient(900px 600px at 20% 30%, rgba(200,245,255,.16), transparent 60%),
        radial-gradient(700px 500px at 70% 75%, rgba(255,84,122,.10), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1) 40%, var(--bg2));
      overflow-x:hidden;
    }
    .wrap{max-width:1100px;margin:0 auto;padding:28px 18px 80px;}
    header{display:flex;align-items:flex-end;justify-content:space-between;gap:14px;margin-bottom:18px;}
    .brand{display:flex;flex-direction:column;gap:8px;}
    .title{
      font-size: clamp(26px, 3.6vw, 46px);
      letter-spacing:.04em;font-weight:800;line-height:1;
      background: linear-gradient(90deg, #ffffff, var(--ice), var(--pearl), #ffffff);
      -webkit-background-clip:text;background-clip:text;color:transparent;
      filter: drop-shadow(0 0 26px rgba(200,245,255,.10));
      background-size: 220% 100%;
      animation: shimmer 7s linear infinite;
    }
    @keyframes shimmer{0%{background-position:0% 50%}100%{background-position:220% 50%}}
    .sub{font-family:var(--mono);color:var(--muted);font-size:12.5px;letter-spacing:.12em;text-transform:uppercase;}
    .pill{
      font-family:var(--mono);
      border:1px solid var(--stroke2);
      background: linear-gradient(180deg, rgba(240,245,255,.09), rgba(240,245,255,.04));
      border-radius:999px;padding:10px 12px;color:var(--muted);
      box-shadow: var(--shadow);backdrop-filter: blur(10px);
      display:flex;gap:10px;align-items:center;white-space:nowrap;
    }
    .dot{width:8px;height:8px;border-radius:50%;
      background: radial-gradient(circle at 30% 30%, #fff, var(--ice));
      box-shadow: 0 0 12px rgba(200,245,255,.35);
      animation:pulse 2.4s ease-in-out infinite;}
    @keyframes pulse{0%,100%{transform:scale(1);opacity:.75}50%{transform:scale(1.6);opacity:1}}
    .grid{display:grid;grid-template-columns:1.1fr .9fr;gap:16px;margin-top:14px;}
    @media (max-width:980px){.grid{grid-template-columns:1fr}header{align-items:flex-start;flex-direction:column}.pill{align-self:flex-start}}
    .card{
      border:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(240,245,255,.08), rgba(240,245,255,.04));
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
      overflow:hidden;
      position:relative;
    }
    .cap{
      padding:14px 16px;border-bottom:1px solid rgba(220,235,255,.10);
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      background: linear-gradient(90deg, rgba(200,245,255,.08), rgba(217,208,255,.06), transparent);
    }
    .cap h3{margin:0;font-family:var(--mono);font-size:12.5px;letter-spacing:.14em;text-transform:uppercase;color:var(--muted)}
    .chip{
      font-family:var(--mono);font-size:12px;color: rgba(234,243,255,.70);
      border:1px solid rgba(220,235,255,.20);border-radius:999px;padding:8px 10px;background: rgba(240,245,255,.05);
      white-space:nowrap;
    }
    .body{padding:16px}
    .manifest{margin:0;padding:0 0 6px;font-size:18px;line-height:1.32;font-weight:700}
    .manifest small{display:block;margin-top:10px;font-family:var(--mono);color:var(--dim);font-weight:500;letter-spacing:.08em;text-transform:uppercase;}
    .hint{font-family:var(--mono);color:var(--dim);font-size:12px;letter-spacing:.08em;line-height:1.3}
    .form{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:14px}
    @media (max-width:640px){.form{grid-template-columns:1fr}}
    label{display:flex;flex-direction:column;gap:8px;font-size:12px;letter-spacing:.12em;text-transform:uppercase;color:var(--dim);font-family:var(--mono)}
    input{
      outline:none;border:1px solid rgba(220,235,255,.18);
      background: rgba(5,11,16,.35);color:var(--text);
      padding:12px 12px;border-radius:14px;font-size:14.5px;font-family:var(--sans);
    }
    input:focus{border-color: rgba(200,245,255,.45);box-shadow:0 0 0 4px rgba(200,245,255,.10)}
    .actions{display:flex;gap:10px;margin-top:14px;flex-wrap:wrap;align-items:center}
    .btn{
      border:1px solid rgba(220,235,255,.22);
      background: linear-gradient(180deg, rgba(240,245,255,.12), rgba(240,245,255,.06));
      color:var(--text);border-radius:16px;padding:12px 14px;
      font-weight:800;letter-spacing:.08em;text-transform:uppercase;font-family:var(--mono);
      cursor:pointer;box-shadow:0 12px 40px rgba(0,0,0,.28);
    }
    .btn.primary{border-color: rgba(200,245,255,.34);background: linear-gradient(90deg, rgba(200,245,255,.14), rgba(217,208,255,.12));position:relative;overflow:hidden}
    .btn.primary:before{
      content:"";position:absolute;inset:-40% -20%;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.22), transparent 40%),
                  radial-gradient(circle at 70% 60%, rgba(200,245,255,.18), transparent 50%);
      transform: rotate(8deg);opacity:.9;pointer-events:none;animation:sweep 2.8s ease-in-out infinite;
    }
    @keyframes sweep{0%,100%{transform:translateX(-12%) rotate(8deg);opacity:.55}50%{transform:translateX(12%) rotate(8deg);opacity:.95}}
    .warn{
      display:none;
      border:1px solid rgba(255,84,122,.35);background: rgba(255,84,122,.08);
      color: rgba(255,210,222,.95);
      border-radius: 16px;padding: 12px 12px;margin-top: 12px;
      font-family: var(--sans);line-height:1.35;
    }
    .warn b{font-family:var(--mono);letter-spacing:.12em;text-transform:uppercase;font-size:12px;display:block;margin-bottom:6px}
    .scanBar{height:10px;background: rgba(240,245,255,.06);border:1px solid rgba(220,235,255,.10);border-radius:999px;overflow:hidden;margin-top:12px}
    .scanFill{height:100%;width:0%;background: linear-gradient(90deg, rgba(200,245,255,.25), rgba(217,208,255,.25), rgba(255,84,122,.18));transition: width 950ms ease}
    .out{display:none}
    .out.show{display:block;animation:reveal .35s ease-out}
    @keyframes reveal{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
    .terminal{
      padding:16px;font-family:var(--mono);
      background:
        linear-gradient(180deg, rgba(5,11,16,.55), rgba(5,11,16,.18)),
        radial-gradient(800px 300px at 10% 10%, rgba(200,245,255,.10), transparent 55%),
        radial-gradient(900px 360px at 80% 30%, rgba(217,208,255,.08), transparent 60%);
      border-top:1px solid rgba(220,235,255,.10);
    }
    .termRow{display:flex;justify-content:space-between;gap:12px;padding:10px 0;border-bottom:1px dashed rgba(220,235,255,.12);flex-wrap:wrap}
    .termRow:last-child{border-bottom:none}
    .k{color: rgba(234,243,255,.60);letter-spacing:.12em;text-transform:uppercase;font-size:12px}
    .v{color: rgba(234,243,255,.95);font-size:13px}
    .lists{margin-top:14px;display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width:820px){.lists{grid-template-columns:1fr}}
    .box{border:1px solid rgba(220,235,255,.14);background: rgba(240,245,255,.05);border-radius:16px;padding:12px}
    .box h4{margin:0 0 10px;font-family:var(--mono);color: rgba(234,243,255,.72);letter-spacing:.14em;text-transform:uppercase;font-size:12px;display:flex;justify-content:space-between;align-items:center;gap:10px}
    .badge{font-family:var(--mono);font-size:11.5px;padding:6px 8px;border-radius:999px;border:1px solid rgba(220,235,255,.20);background: rgba(5,11,16,.35);color: rgba(234,243,255,.72)}
    .box ul{margin:0;padding-left:16px;color: rgba(234,243,255,.86);line-height:1.45;font-size:14px;font-family:var(--sans)}
    details{border:1px solid rgba(220,235,255,.14);border-radius:16px;background: rgba(240,245,255,.05);padding:10px 12px;margin-top:12px}
    summary{cursor:pointer;font-family:var(--mono);letter-spacing:.12em;text-transform:uppercase;font-size:12px;color: rgba(234,243,255,.72);list-style:none;display:flex;justify-content:space-between;align-items:center;gap:10px}
    summary::-webkit-details-marker{display:none}
    .small{margin-top:10px;color: rgba(234,243,255,.80);line-height:1.45;font-size:14px;font-family:var(--sans)}
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="title">ADM MODE</div>
        <div class="sub">MAP / Сканирование персонажа • MULTIPASS EXTENDED</div>
      </div>
      <div class="pill">
        <span class="dot"></span>
        <span>STATUS: ONLINE</span>
        <span style="opacity:.55">•</span>
        <span>TERMINAL: READY</span>
      </div>
    </header>

    <div class="grid">
      <section class="card">
        <div class="cap">
          <h3>TERMINAL</h3>
          <span class="chip">INPUT → SCAN → OUTPUT</span>
        </div>
        <div class="body">
          <p class="manifest" id="manifestText"></p>
          <p class="hint">Введи дату и нажми “СКАНИРОВАНИЕ”. Генерация детерминированная: одинаковый ввод = одинаковый MULTIPASS.</p>

          <div class="form">
            <label>дата рождения
              <input id="dob" type="text" inputmode="numeric" placeholder="ДД.ММ.ГГГГ (например 01.08.1996)">
            </label>
            <label>имя / ник (опционально)
              <input id="name" type="text" placeholder="Любое имя">
            </label>
          </div>

          <div class="actions">
            <button class="btn primary" id="scanBtn">СКАНИРОВАНИЕ</button>
            <button class="btn" id="clearBtn">СБРОС</button>
            <span class="hint" id="helper">После скана появится полный MULTIPASS EXTENDED + скрытые поля.</span>
          </div>

          <div class="scanBar" aria-hidden="true"><div class="scanFill" id="scanFill"></div></div>

          <div class="warn" id="inputWarn">
            <b>WARNING</b>
            Введи дату в формате <span style="font-family:var(--mono)">ДД.ММ.ГГГГ</span>.
          </div>
        </div>
      </section>

      <section class="card">
        <div class="cap">
          <h3>MULTIPASS OUTPUT</h3>
          <span class="chip" id="outChip">WAITING FOR INPUT</span>
        </div>

        <div class="out" id="out">
          <div class="terminal" id="terminal"></div>
        </div>

        <div class="body" id="outPlaceholder">
          <p class="hint" style="margin:0;">Результат появится здесь после сканирования.</p>
        </div>
      </section>
    </div>
  </div>

<script>
/* ========= ADM MODE генератор (богатый для всех) ========= */

const manifestPool = [
  "Если система закрывает двери — я становлюсь дверью.<br/>Если система ставит границы — я становлюсь линией разрыва.<small>манифест меняется каждый запуск</small>",
  "Система не выдаёт разрешений. Система фиксирует факт.<br/>Ты не просишь доступ. Ты подтверждаешь допуск.<small>манифест меняется каждый запуск</small>",
  "Там, где другие ждут — я запускаю.<br/>Там, где другие сомневаются — я фиксирую выбор.<small>манифест меняется каждый запуск</small>",
  "Я не «исправляюсь». Я переключаю режим.<br/>Я не убеждаю. Я запускаю протокол.<small>манифест меняется каждый запуск</small>",
  "Слабость — это не боль. Слабость — это зависимость.<br/>ADM MODE отключает зависимость.<small>манифест меняется каждый запуск</small>"
];

const $ = (id)=>document.getElementById(id);
const dobEl = $("dob"), nameEl = $("name");
const scanBtn = $("scanBtn"), clearBtn = $("clearBtn");
const out = $("out"), terminal = $("terminal");
const outChip = $("outChip"), outPlaceholder = $("outPlaceholder");
const manifestText = $("manifestText"), scanFill = $("scanFill");
const warn = $("inputWarn"), helper = $("helper");

setManifest();

function setManifest(){
  manifestText.innerHTML = manifestPool[Math.floor(Math.random()*manifestPool.length)];
}

function validDOB(d){
  const m = /^(\d{2})\.(\d{2})\.(\d{4})$/.exec((d||"").trim());
  if(!m) return false;
  const dd = +m[1], mm=+m[2], yy=+m[3];
  if(mm<1||mm>12||dd<1||dd>31||yy<1900||yy>2100) return false;
  const dt = new Date(yy, mm-1, dd);
  return dt && dt.getFullYear()===yy && dt.getMonth()===(mm-1) && dt.getDate()===dd;
}

// FNV-1a
function hashStr(str){
  let h = 2166136261;
  for(let i=0;i<str.length;i++){
    h ^= str.charCodeAt(i);
    h = Math.imul(h, 16777619);
  }
  return (h>>>0);
}
function mulberry32(seed){
  return function(){
    let t = seed += 0x6D2B79F5;
    t = Math.imul(t ^ (t >>> 15), t | 1);
    t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
    return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
  }
}
function pick(rng, arr){ return arr[Math.floor(rng()*arr.length)]; }
function shuffle(rng, arr){
  const a = arr.slice();
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(rng()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}
function makeId(dob){
  const m = /^(\d{2})\.(\d{2})\.(\d{4})$/.exec(dob);
  return `108-${m[1]}${m[2]}${m[3].slice(2)}`;
}
function pad2(n){ return String(n).padStart(2,"0"); }

function computeProfile(rng, dob, name){
  const archetypes = [
    {a:"Catalyst / Breakpoint", role:"Trigger Unit", pos:"Outside Grid", tag:"HIGH IMPACT"},
    {a:"Architect of Chaos", role:"System Rewriter", pos:"Edge Node", tag:"SYSTEM SHIFT"},
    {a:"Cold Operator", role:"Decision Engine", pos:"Silent Core", tag:"NOISELESS"},
    {a:"Signal Distorter", role:"Pattern Breaker", pos:"Off-Route", tag:"ANTI-PATTERN"},
    {a:"Apex Initiator", role:"Gate Opener", pos:"No Man’s Zone", tag:"ACCESS"},
    {a:"Pressure Reactor", role:"Impact Unit", pos:"Borderline", tag:"OVERLOAD"}
  ];

  const engines = [
    {type:"Internal Pressure", mode:"Compression → Release", note:"тебе нельзя долго удерживать импульс — он превращается в яд."},
    {type:"Focus Spike", mode:"Silence → Strike", note:"ты копишь тишину, а потом делаешь один точный удар."},
    {type:"Anger as Fuel", mode:"Friction → Force", note:"сопротивление среды заряжает тебя. без трения ты засыпаешь."},
    {type:"Void Drive", mode:"Empty → Exact", note:"пустота — твой ресурс. шум — твой враг."},
    {type:"High Voltage Will", mode:"Load → Break", note:"чем выше давление — тем точнее ты становишься."}
  ];

  const thinking = [
    {mode:"Non-linear", percep:"Multi-layer", decision:"Instant / Irreversible"},
    {mode:"Strategic", percep:"Threat-aware", decision:"Fast / Cold"},
    {mode:"Pattern Hunter", percep:"X-ray", decision:"Binary / No Return"},
    {mode:"Surgical", percep:"Minimalism", decision:"Precise / Final"}
  ];

  const social = [
    {mode:"Observer / Out of Role", text:"ты считываешь фальшь быстрее, чем люди успевают сыграть."},
    {mode:"Selective Contact", text:"ты выбираешь окружение как инструмент: по функции, не по эмоции."},
    {mode:"No Hierarchy", text:"иерархии без смысла вызывают внутренний отказ."},
    {mode:"Controlled Exposure", text:"ты либо близко, либо далеко. середины мало."}
  ];

  const strengths = [
    "иммунитет к массовым сценариям",
    "высокая автономность мышления",
    "способность действовать без поддержки",
    "устойчивость к хаосу",
    "быстрое считывание мотивов",
    "точность решений под давлением",
    "умение держать пустоту",
    "резкое восстановление после ударов",
    "невосприимчивость к манипуляциям",
    "умение резать лишнее без жалости"
  ];

  const vulnerabilities = [
    "перегрев при задержке действия",
    "нетерпимость к фальши",
    "резкие обрывы без объяснений",
    "отвращение к медленному темпу",
    "выгорание при попытке быть «нормальным»",
    "самоконтроль вместо действия",
    "внутренняя ярость при ограничениях",
    "скука как саботаж",
    "непереносимость пустых разговоров"
  ];

  const blockers = [
    {type:"Overcontrol", trigger:"External Expectations", fix:"отключается действием, не анализом"},
    {type:"Delay Start", trigger:"Fear of Wrong Move", fix:"лечится одним запуском"},
    {type:"People Anchor", trigger:"Loyalty to Dead Links", fix:"отрезается без переговоров"},
    {type:"Explanation Loop", trigger:"Need to Be Understood", fix:"снимается молчанием + результатом"},
    {type:"Perfection Trap", trigger:"High Inner Bar", fix:"ломается грубым прототипом"}
  ];

  const routing = [
    {priority:"HIGH", shift:"ACTIVE", fail:"Passive Observation", rule:"если ты смотришь — ты не управляешь"},
    {priority:"VERY HIGH", shift:"ACTIVE", fail:"Doubt / Delay", rule:"сомнение — это слив ветки"},
    {priority:"HIGH", shift:"ACTIVE", fail:"Waiting for Signs", rule:"знаки приходят после действия, не до"}
  ];

  const prohibited = [
    "роль ученика",
    "ожидание разрешения",
    "зависимость от авторитетов",
    "жизнь по инструкции",
    "коллективные цели без смысла",
    "попытка быть удобным",
    "объяснения вместо результата",
    "долгие переговоры с мёртвыми связями"
  ];

  const optimal = [
    "одиночные циклы",
    "резкие решения",
    "ограниченное окружение",
    "высокая концентрация",
    "минимум объяснений",
    "перезапуск среды действиями",
    "короткие рывки → пауза",
    "работа в тишине"
  ];

  const privatePool = [
    "ты не обязана быть понятой. ты обязана быть точной.",
    "если ты ждёшь — ветка уходит. если действуешь — ветка перестраивается.",
    "система не спорит. система фиксирует факт. действуй.",
    "никогда не объясняй там, где достаточно результата.",
    "не лечи то, что можно отключить."
  ];

  const m = /^(\d{2})\.(\d{2})\.(\d{4})$/.exec(dob);
  const dd = +m[1], mm = +m[2], yy = +m[3];

  const arch = pick(rng, archetypes);
  const eng  = pick(rng, engines);
  const th   = pick(rng, thinking);
  const soc  = pick(rng, social);
  const blk  = pick(rng, blockers);
  const rt   = pick(rng, routing);

  const sPick = shuffle(rng, strengths).slice(0,6);
  const vPick = shuffle(rng, vulnerabilities).slice(0,5);
  const pPick = shuffle(rng, prohibited).slice(0,5);
  const oPick = shuffle(rng, optimal).slice(0,5);

  // hooks for “узнавание”
  const hooks = [];
  if(dd === 1) hooks.push("у тебя врождённая тяга к старту. если не стартуешь — энергия становится ядом.");
  if(dd >= 20) hooks.push("ты плохо переносишь ожидание. чем дольше пауза — тем жестче будет срыв.");
  if(mm === 1) hooks.push("твоя сила — личная независимость. слабое место — гордость, которая не просит помощи даже когда надо.");
  if(mm === 8) hooks.push("твоя зона силы — лидерство без просьбы. слабое место — внутренняя планка, которая тормозит запуск.");
  if(yy % 2 === 0) hooks.push("ты быстрее реагируешь телом, чем словами: ощущения точнее объяснений.");
  if((name||"").trim().length > 0) hooks.push("твоё имя в системе — якорь. используй его как команду, не как украшение.");

  return {arch, eng, th, soc, blk, rt, sPick, vPick, pPick, oPick, hooks, privateMsg: pick(rng, privatePool)};
}

function render(profile, dob, name){
  const id = makeId(dob);
  const displayName = (name||"").trim() ? (name||"").trim() : "UNNAMED";

  const hookText = profile.hooks.length
    ? ("• " + profile.hooks.join("\n• "))
    : "• система не выдаёт лести. только функциональный профиль.";

  return `
<div class="termRow"><div class="k">MULTIPASS</div><div class="v">EXTENDED / ACTIVE</div></div>
<div class="termRow"><div class="k">ID</div><div class="v">${id}</div></div>
<div class="termRow"><div class="k">ENTITY</div><div class="v">${escapeHtml(displayName)}</div></div>
<div class="termRow"><div class="k">DATE OF BIRTH</div><div class="v">${dob}</div></div>
<div class="termRow"><div class="k">CLEARANCE</div><div class="v">AUTONOMOUS</div></div>
<div class="termRow"><div class="k">SYSTEM FLAG</div><div class="v">${profile.arch.tag}</div></div>
<div class="termRow"><div class="k">ARCHETYPE</div><div class="v">${profile.arch.a}</div></div>
<div class="termRow"><div class="k">ROLE</div><div class="v">${profile.arch.role}</div></div>
<div class="termRow"><div class="k">DEFAULT POSITION</div><div class="v">${profile.arch.pos}</div></div>

<div class="lists">
  <div class="box">
    <h4>ENERGY ENGINE <span class="badge">${profile.eng.type}</span></h4>
    <div class="small"><b style="font-family:var(--mono);letter-spacing:.12em;text-transform:uppercase;font-size:12px;color:rgba(234,243,255,.7)">MODE</b><br/>
      ${profile.eng.mode}<br/><br/>
      ${profile.eng.note}
    </div>
  </div>

  <div class="box">
    <h4>COGNITIVE PATTERN <span class="badge">${profile.th.mode}</span></h4>
    <div class="small">
      <b style="font-family:var(--mono);letter-spacing:.12em;text-transform:uppercase;font-size:12px;color:rgba(234,243,255,.7)">PERCEPTION</b><br/>
      ${profile.th.percep}<br/><br/>
      <b style="font-family:var(--mono);letter-spacing:.12em;text-transform:uppercase;font-size:12px;color:rgba(234,243,255,.7)">DECISION</b><br/>
      ${profile.th.decision}
    </div>
  </div>
</div>

<div class="lists">
  <div class="box">
    <h4>SOCIAL INTERFACE <span class="badge">${profile.soc.mode}</span></h4>
    <div class="small">${profile.soc.text}</div>
  </div>

  <div class="box">
    <h4>BLOCKER (DEFAULT) <span class="badge">${profile.blk.type}</span></h4>
    <div class="small">
      <b style="font-family:var(--mono);letter-spacing:.12em;text-transform:uppercase;font-size:12px;color:rgba(234,243,255,.7)">TRIGGER</b><br/>
      ${profile.blk.trigger}<br/><br/>
      <b style="font-family:var(--mono);letter-spacing:.12em;text-transform:uppercase;font-size:12px;color:rgba(234,243,255,.7)">FIX</b><br/>
      ${profile.blk.fix}
    </div>
  </div>
</div>

<div class="lists">
  <div class="box">
    <h4>STRENGTH MATRIX <span class="badge">ACTIVE</span></h4>
    <ul>${profile.sPick.map(x=>`<li>${x}</li>`).join("")}</ul>
  </div>

  <div class="box">
    <h4>VULNERABILITY ZONES <span class="badge">RISK</span></h4>
    <ul>${profile.vPick.map(x=>`<li>${x}</li>`).join("")}</ul>
  </div>
</div>

<div class="lists">
  <div class="box">
    <h4>RESTRICTED MODES <span class="badge">FORBIDDEN</span></h4>
    <ul>${profile.pPick.map(x=>`<li>${x}</li>`).join("")}</ul>
  </div>

  <div class="box">
    <h4>OPTIMAL MODES <span class="badge">RECOMMENDED</span></h4>
    <ul>${profile.oPick.map(x=>`<li>${x}</li>`).join("")}</ul>
  </div>
</div>

<details>
  <summary>REALITY ROUTING <span class="badge">OPEN</span></summary>
  <div class="small">
    <div class="termRow"><div class="k">PRIORITY</div><div class="v">${profile.rt.priority}</div></div>
    <div class="termRow"><div class="k">SHIFT CAPACITY</div><div class="v">${profile.rt.shift}</div></div>
    <div class="termRow"><div class="k">FAIL MODE</div><div class="v">${profile.rt.fail}</div></div>
    <div class="small" style="margin-top:10px;">${profile.rt.rule}.</div>
  </div>
</details>

<details>
  <summary>RECOGNITION HOOKS <span class="badge">PERSONAL</span></summary>
  <div class="small" style="white-space:pre-line">${hookText}</div>
</details>

<details>
  <summary>PRIVATE SYSTEM MESSAGE <span class="badge">LOCKED</span></summary>
  <div class="small">${profile.privateMsg}</div>
</details>

<div class="termRow" style="margin-top:10px">
  <div class="k">STATUS</div><div class="v">FEATURE — NOT FAILURE</div>
</div>
`;
}

function escapeHtml(str){
  return (str||"").replace(/[&<>"']/g, (m)=>({
    "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#039;"
  }[m]));
}

function runScan(){
  const dob = (dobEl.value||"").trim();
  const name = (nameEl.value||"").trim();

  if(!validDOB(dob)){
    warn.style.display = "block";
    return;
  }
  warn.style.display = "none";

  // progress
  scanFill.style.width = "0%";
  setTimeout(()=> scanFill.style.width = "100%", 50);

  const seed = hashStr(`${dob}|${name}|ADM MODE`);
  const rng = mulberry32(seed);

  const profile = computeProfile(rng, dob, name);
  const html = render(profile, dob, name);

  outPlaceholder.style.display = "none";
  out.classList.add("show");
  out.style.display = "block";
  terminal.innerHTML = html;
  outChip.textContent = "SCAN COMPLETE";
  helper.textContent = "Готово. MULTIPASS сгенерирован. Одинаковые данные → одинаковый результат.";

  // new manifest after scan
  setManifest();
}

function clearAll(){
  dobEl.value = "";
  nameEl.value = "";
  out.style.display = "none";
  out.classList.remove("show");
  outPlaceholder.style.display = "block";
  outChip.textContent = "WAITING FOR INPUT";
  scanFill.style.width = "0%";
  warn.style.display = "none";
  helper.textContent = "После скана появится полный MULTIPASS EXTENDED + скрытые поля.";
  setManifest();
}

scanBtn.addEventListener("click", runScan);
clearBtn.addEventListener("click", clearAll);
</script>
</body>
</html>